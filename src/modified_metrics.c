#include "modified_metrics.h"

#include "decs.h"
#include "geometry.h"

int theory = 2; //Theory of Gravity: 0 for General Relativity, 1 for EdGB, and 2 for DCS
double zeta = 0.1; //Deviation from Gravity: Should be between 0 and 0.3
double a;
double Rh;

void gcov_EdGB_ks(double r, double th, double gcov[NDIM][NDIM]){
//Return the Einstein dilaton Gauss Bonet metric in KS coordinates

  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a4 = a2*a2;

   MUNULOOP gcov[mu][nu] = 0.;
  // Compute EdGB metric from KS coordinates (cyclic in t,phi)

  gcov[0][0] = -1. + 2.*r/rho2
    + zeta*(-1./15.*(-400.+96.*r+66.*pow(r,2)+130.*pow(r,3)+5.*pow(r,4))/pow(r,7)
    + (a2*(pow(r,7)*(444696.-562338.*c2)  + 8820000.*(-1. + 3.*c2) - 19600.*r*(-467. + 1251.*c2) - 63.*pow(r,8)*(-3267. + 8926.*c2) 
    + 1050.*pow(r,3)*(-1465. + 11997.*c2) - 2100.*pow(r,2)*(-955. + 22577.*c2) - 6.*pow(r,6)*(-59329. + 82437.*c2) + 15.*pow(r,5)*(-52533. + 455029.*c2) 
    + 10.*pow(r,4)*(-281221. + 1218513.*c2)))/(110250.*pow(r,11))+ (a4*(675.*pow(r,12)*(-19717. + 67726.*c2) + 450.*pow(r,11)*(43312. + 101589.*c2) 
    - 164640000.*(-70. + 585.*c2 + 156.*c4) - 8232000.*r*(3949. - 11058.*c2 + 6948.*c4) - 39200.*pow(r,2)*(189191. - 824825.*c2 + 972045.*c4) 
    + 60.*pow(r,9)*(717867. - 13885852.*c2 + 12733507.*c4) + 30.*pow(r,10)*(209773. - 9090216.*c2 + 16888370.*c4) + 1400.*pow(r,3)*(648009. - 14691730.*c2 
    + 26074500.*c4) + 420.*pow(r,4)*(553219. - 32471380.*c2 + 222891320.*c4) - 14.*pow(r,7)*(-11393603. + 38599350.*c2 + 359928985.*c4) 
    + 2.*pow(r,8)*(59964679. - 491173980.*c2 + 452824800.*c4) - 28.*pow(r,5)*(21852807. + 12094180.*c2 + 762315255.*c4) 
    - 14.*pow(r,6)*(42004007. - 226439060.*c2 + 1041312310.*c4)))/(30870000.*pow(r,15)));



  gcov[0][1] = 2.*r/rho2
    + zeta*(-1./30.*(-800. + 912.*r + 516.*pow(r,2) + 470.*pow(r,3) + 50.*pow(r,4) + 15.*pow(r,5))/ pow(r,7) 
    + (a2*(-566034.*pow(r,8) + 55125.*pow(r,9) +  17640000.*(-1. + 3.*c2) + 12600.*pow(r,3)*(4006. + 1877.*c2) + 78400.*r*(-779. + 2412.*c2) + 42.*pow(r,7)*(-94339. 
    + 107112.*c2) - 1400.*pow(r,2)*(20431. + 132243.*c2) + 36.*pow(r,6)*(-436917. + 491281.*c2) + 20.*pow(r,4)*(-875941. + 2263053.*c2) + 20.*pow(r,5)*(-1122937. 
    + 2632446.*c2)))/(220500.*pow(r,11))- (a4*(-80247150.*pow(r,12) - 5788125.*pow(r,13) + 450.*pow(r,11)*(-1196839. + 812712.*c2) 
    + 329280000.*(-70. + 585.*c2 + 156.*c4) + 49392000.*r*(-1717. + 21664.*c2 + 9076.*c4) + 60.*pow(r,10)*(-23601289. + 13406112.*c2 + 2187250.*c4) 
    + 78400.*pow(r,2)*(-2206069. - 11318105.*c2 + 13657725.*c4) + 14000.*pow(r,3)*(22540153. - 88517480.*c2 + 62290230.*c4) 
    + 30.*pow(r,9)*(-145291221. + 30934768.*c2 + 146683252.*c4) + 280.*pow(r,4)*(793805393. - 2014699860.*c2 + 507428040.*c4) 
    + 28.*pow(r,6)*(-711534337. - 1340707620.*c2 + 4191169150.*c4) + 28.*pow(r,5)*(2484408549. - 2498856340.*c2 + 4680981810.*c4) 
    + 14.*pow(r,7)*(-1576790517. - 1991632680.*c2 + 4890821060.*c4) + 4.*pow(r,8)*(-2741883352. - 2122491690.*c2 + 5145464715.*c4)))/(61740000.*pow(r,15)));



  gcov[0][3] = -2.*a*r*s2/rho2
   + zeta*(-1./15.*((-400. + 144.*r + 90.*pow(r,2) + 140.*pow(r,3) 
    + 9.*pow(r,4))*a*(-1. + c2))/pow(r,7) - (pow(a,3)*(-1. + c2)* (pow(r,4)*(2736210. - 4410530.*c2) + pow(r,5)*(766015. - 3620183.*c2) - 
    8820000.*(-1. + 3.*c2) + 19600.*r*(-467. + 1551.*c2) - 12.*pow(r,6)*(26511. +  6310.*c2) + 750.*pow(r,3)*(2051. + 8733.*c2) +  2100.*pow(r,2)*(-955. + 21233.*c2) 
    + 3.*pow(r,8)*(-63529. + 262520.*c2) + pow(r,7)*(-406611. + 563055.*c2)))/(110250.*pow(r,11)));



  gcov[1][0] = gcov[0][1];

  gcov[1][1] = 1. + 2.*r/rho2 
    + zeta*(-1./15.*(-400. + 816.*r + 450.*pow(r,2) + 340.*pow(r,3) + 45.*pow(r,4) + 15.*pow(r,5))/pow(r,7) 
    + (a2*(55125.*pow(r,9) + 8820000.*(-1. + 3.*c2) + 1050.*pow(r,3)*(49537. + 10527.*c2) + 19600.*r*(-3583. + 10899.*c2) + 21.*pow(r,8)*(-36755. + 26778.*c2) 
    + 42.*pow(r,7)*(-104927. + 120501.*c2) - 700.*pow(r,2)*(43727. + 196755.*c2) + 6.*pow(r,6)*(-2680831. + 3030123.*c2) + 10.*pow(r,4)*(-1470661. + 3307593.*c2) 
    + 5.*pow(r,5)*(-4334149. + 9164697.*c2)))/(110250.*pow(r,11))- (a4*(-5788125.*pow(r,13) + 225.*pow(r,12)*(-415805. + 203178.*c2) 
    + 1350.*pow(r,11)*(-384509. + 304767.*c2) + 164640000.*(-70. + 585.*c2 + 156.*c4) + 8232000.*r*(-14251. + 141042.*c2 + 47508.*c4) 
    + 30.*pow(r,10)*(-46992805. + 17722008.*c2 + 21262870.*c4) + 39200.*pow(r,2)*(-4601329. - 21811385.*c2 + 26343405.*c4) 
    + 30.*pow(r,9)*(-143855487. + 3163064.*c2 + 172150266.*c4) + 1400.*pow(r,3)*(226049539. - 899866530.*c2 + 648976800.*c4) 
    + 140.*pow(r,4)*(1589270443. - 4126813860.*c2 + 1683530040.*c4) + 10.*pow(r,8)*(-1084760405. - 947231472.*c2 + 2148750846.*c4) 
    + 28.*pow(r,5)*(2462555742. - 2510950520.*c2 + 3918666555.*c4) + 14.*pow(r,7)*(-1565396914. - 2030232030.*c2 + 4530892075.*c4) 
    + 14.*pow(r,6)*(-1465072681. - 2454976180.*c2 + 7341025990.*c4)))/(30870000.*pow(r,15)));  



  gcov[1][3] = -a *s2*(1. + 2.*r/rho2)
    + zeta*(-1./36750.*((16660000. - 5350800.*r + 4797450.*pow(r,2) + 3526600.*pow(r,3) 
    + 2965560.*pow(r,4) + 918855.*pow(r,5) + 187446.*pow(r,6))*a*(-1. + c2))/pow(r,7)+ (pow(a,3)*(-1. + c2)*(22085775.*pow(r,9) 
    + 4571505.*pow(r,10) + 49392000.*(580. + 327.*c2) + 548800.*r*(-23041. + 74715.*c2) + 6300.*pow(r,3)*(-446807. + 973501.*c2) 
    + 126.*pow(r,7)*(1064483. + 1485790.*c2) + 9800.*pow(r,2)*(-1223527. + 1991748.*c2) + 12.*pow(r,8)*(4458631. + 3456783.*c2) 
    + 280.*pow(r,4)*(3773463. + 15733496.*c2) + 42.*pow(r,6)*(6767669. + 23527525.*c2) + 56.*pow(r,5)*(17855552. + 49207893.*c2)))/(3087000.*pow(r,11)));



  gcov[2][2] = rho2
  + ((8820000. - 6213200.*r - 3416700.*pow(r,2) - 1855650.*pow(r,3) + 887110.*pow(r,4) + 800733.*pow(r,5) + 435540.*pow(r,6) 
   + 187446.*pow(r,7))*a2*zeta*(1. - 3.*c2))/(110250.*pow(r,8))+ (a4*zeta*(45715050.*pow(r,11)*(-1. + 3.*c2) + 5625.*pow(r,10)*(-20749. + 58131.*c2) 
   + 493920000.*(-70. + 585.*c2 + 156.*c4) + 24696000.*r*(3049. - 10698.*c2 + 8868.*c4) + 117600.*pow(r,2)*(280331. - 1711445.*c2 + 1596165.*c4) 
   + 180.*pow(r,9)*(-1286466. - 846865.*c2 + 5819941.*c4) + 4200.*pow(r,3)*(2362411. - 16650910.*c2 + 14489100.*c4) 
   - 1260.*pow(r,4)*(-3173281. - 5026080.*c2 + 26477920.*c4) + 42.*pow(r,8)*(-18071967. - 940590.*c2 + 54146980.*c4) 
   + 42.*pow(r,6)*(-19116713. - 46592740.*c2 + 138130070.*c4) - 28.*pow(r,5)*(11804979. - 261030540.*c2 + 235282135.*c4) 
   + 6.*pow(r,7)*(-259078241. - 99440670.*c2 + 857000595.*c4)))/(92610000.*pow(r,12));


  gcov[3][0] = gcov[0][3];
  gcov[3][1] = gcov[1][3];

  gcov[3][3] =s2 * (rho2+a2*s2*(1. + 2. *r/rho2))
    + zeta*(((8820000. - 6213200.*r - 3416700.*pow(r,2) - 1855650.*pow(r,3) + 887110.*pow(r,4) + 800733.*pow(r,5) + 435540.*pow(r,6) 
    + 187446.*pow(r,7))*a2* (-1. + c2)*(-1. + 3.*c2))/(110250.*pow(r,8)) -  (a4*(-1. + c2)*(45715050.*pow(r,11)*(-1. + 3.*c2) 
    + 5625.*pow(r,10)*(-20749. + 58131.*c2) + 493920000.*(-70. + 585.*c2 + 156.*c4) + 24696000.*r*(3649. - 8958.*c2 + 6528.*c4) 
    + 352800.*pow(r,2)*(84857. - 350495.*c2 + 320655.*c4) + 12600.*pow(r,3)*(-82303. - 1443030.*c2 + 1592200.*c4) 
    + 180.*pow(r,9)*(-411718. - 4345857.*c2 + 8444185.*c4) - 1260.*pow(r,4)*(1578719. - 11450880.*c2 + 28150720.*c4) 
    + 42.*pow(r,8)*(-1863327. - 67980150.*c2 + 104977900.*c4) + 28.*pow(r,5)*(-14247879. - 109560360.*c2 + 137751665.*c4) 
    + 42.*pow(r,6)*(30654807. - 316973820.*c2 + 358739630.*c4) + 6.*pow(r,7)*(-25024421. - 1143700950.*c2 + 1667207055.*c4)))/(92610000.*pow(r,12)));

}
void gcov_DCS_ks(double r, double th, double gcov[NDIM][NDIM]){
//Return the Dynamical Chern-Simons metric in KS coordinates
  
  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a4 = a2*a2;

    MUNULOOP gcov[mu][nu] = 0.;
  // Compute DCS metric from KS coordinates (cyclic in t,phi)
  
  gcov[0][0] = -1. + 2.*r/rho2
    + zeta*((a2*(-338688.*(-1. + 3.*c2) + 4221.*pow(r,6.)*(-1. + 3.*c2) + 4221.*pow(r,7.)*(-1. + 3.*c2) 
    - 420.*pow(r,2.)*(263. + 321.*c2) + 20.*pow(r,3.)*(-5428. + 2025.*c2) - 20.*pow(r,4.)*(1523. + 2781.*c2) + 168.*r*(-275. + 3471.*c2) 
    + 2.*pow(r,5.)*(-2482. + 6711.*c2)))/(37632.*pow(r,10.)) + (a4*(-436560.*pow(r,10.)*(-1. + 3.*c2) - 436560.*pow(r,11.)*(-1. + 3.*c2) 
    + pow(r,5.)*(-27367138. + 338395440.*c2 - 79842960.*c4) + pow(r,7.)*(5994779. + 9180120.*c2 - 23096700.*c4) 
    + pow(r,8.)*(1835988. + 14588424.*c2 - 20269020.*c4) + pow(r,9.)*(609036. + 6695880.*c2 - 14028580.*c4) 
    - 3048192.*(299. - 1440.*c2 + 720.*c4) + 1512.*r*(200377. - 262200.*c2 + 546900.*c4) 
    + 540.*pow(r,2.)*(209695. - 1641704.*c2 + 3850652.*c4) + 36.*pow(r,4.)*(-1309617. + 14023212.*c2 + 5328620.*c4) 
    + pow(r,6.)*(1493875. + 66961128.*c2 + 66934880.*c4) - 12.*pow(r,3.)*(-7413845. - 9229392.*c2 + 156818740.*c4)))/(13547520.*pow(r,14.)));

 

  gcov[0][1] = 2.*r/rho2
    + zeta*((a2*(8442.*pow(r,7.) + pow(r,4.)*(504690. - 543240.*c2) + pow(r,6.)*(55419. - 50652.*c2) - 338688.*(-1. + 3.*c2) 
    - 2016.*pow(r,2.)*(-747. + 1291.*c2) - 168.*r*(-7789. + 20721.*c2) - 20.*pow(r,3.)*(-50957. + 73764.*c2) 
    - 2.*pow(r,5.)*(-94018. + 97629.*c2)))/(37632.*pow(r,10.)) + (a4*(-1746240.*pow(r,11.) + 240.*pow(r,10.)*(-48727. + 43656.*c2) 
    - 6096384.*(299. - 1440.*c2 + 720.*c4) + 8.*pow(r,9.)*(-4902855. + 3171874.*c2 + 332305.*c4) 
    - 3456.*pow(r,2.)*(5955596. - 12196010.*c2 + 3150155.*c4) - 3024.*r*(3416327. - 17156040.*c2 + 8162220.*c4) 
    + 96.*pow(r,3.)*(-80010145. + 69893298.*c2 + 34916840.*c4) + 8.*pow(r,7.)*(-55039417. - 5982330.*c2 + 69327885.*c4) 
    + pow(r,8.)*(-164813529. + 45059288.*c2 + 116931460.*c4) + 36.*pow(r,4.)*(-27676299. - 98275560.*c2 + 239844820.*c4)
     + 8.*pow(r,6.)*(-76467017. - 93284976.*c2 + 253740770.*c4) + 4.*pow(r,5.)*(-83689817. - 868048872.*c2 + 1345549080.*c4)))/(27095040.*pow(r,14.)));

  
  gcov[0][3] = -2.*a*r*s2/rho2
     +zeta*(-1./112.*((189. + 120.*r + 70.*pow(r,2.))*a*(-1. + c2))/pow(r,6.) + (pow(a,3)*(-1. + c2)*(-10160640.*(-1. + 3.*c2) 
     + 105828.*pow(r,7.)*(-1. + 5.*c2) + 30.*pow(r,5.)*(2247. + 95.*c2) + 55440.*r*(-25. + 453.*c2) + 15.*pow(r,6.)*(-271. + 24875.*c2) 
     + 360.*pow(r,2.)*(-9205. + 64257.*c2) + 16.*pow(r,4.)*(-40883. + 112735.*c2) + 8.*pow(r,3.)*(-382792. + 1712045.*c2)))/(1128960.*pow(r,10.))); 

  

  gcov[1][0] = gcov[0][1];


  gcov[1][1] = 1. + 2.*r/rho2
    + zeta*(-1./37632.*(a2*(4221.*pow(r,7.)*(-5. + 3.*c2) + 338688.*(-1. + 3.*c2) + 3820.*pow(r,3.)*(-562. + 783.*c2) 
    + 21.*pow(r,6.)*(-5479. + 5427.*c2) + 168.*r*(-15853. + 44913.*c2) + 20.*pow(r,4.)*(-51992. + 51543.*c2) 
    + 84.*pow(r,2.)*(-37171. + 60363.*c2) + 6.*pow(r,5.)*(-63506. + 67323.*c2)))/pow(r,10.) + (a4*(436560.*pow(r,11.)*(-5. + 3.*c2) 
    + 240.*pow(r,10.)*(-50546. + 49113.*c2) - 3048192.*(299. - 1440.*c2 + 720.*c4) 
    + 4.*pow(r,9.)*(-9957969. + 4669778.*c2 + 4171755.*c4) - 1512.*r*(7033031. - 34574280.*c2 + 16871340.*c4) 
    + 5.*pow(r,7.)*(-89262023. - 11407752.*c2 + 115543956.*c4) + 72.*pow(r,4.)*(-13183341. - 56149386.*c2 + 117258100.*c4) 
    - 108.*pow(r,2.)*(191627547. - 398480840.*c2 + 120058220.*c4) + pow(r,8.)*(-166649517. + 30470864.*c2 + 137200480.*c4) 
    + 12.*pow(r,3.)*(-647495005. + 549916992.*c2 + 436153460.*c4) + pow(r,6.)*(-613230011. - 813240936.*c2 + 1962991280.*c4) 
    + pow(r,5.)*(-307392130. - 3810590928.*c2 + 5462039280.*c4)))/(13547520.*pow(r,14.)));



  gcov[1][3] = -a *s2*(1. + 2.*r/rho2)
  +zeta*(((571536. + 393540.*r + 219380.*pow(r,2.) + 64660.*pow(r,3.) + 19880.*pow(r,4.) + 4221.*pow(r,5.))*a*(-1. + c2))/(12544.*pow(r,6.)) 
  - (pow(a,3)*(-1. + c2)*(1570950.*pow(r,8.) + 327420.*pow(r,9.) - 60963840.*(-49. + 48.*c2) - 7560.*r*(-133087. + 6297.*c2) 
  + 1620.*pow(r,2.)*(47721. + 449461.*c2) + 25.*pow(r,6.)*(711795. + 481847.*c2) + 30.*pow(r,5.)*(1256960. + 2241169.*c2) 
  + pow(r,7.)*(4312974. + 2699780.*c2) + 120.*pow(r,3.)*(-870409. + 5949739.*c2) + 12.*pow(r,4.)*(379503. + 21372890.*c2)))/(3386880.*pow(r,10.)));

 

  gcov[2][2] = rho2  
     -(zeta*(1080.*pow(r,4.)*(338688. + 80808.*r + 67380.*pow(r,2.) + 10360.*pow(r,3.) + 18908.*pow(r,4.) + 9940.*pow(r,5.) 
     + 4221.*pow(r,6.))*a2*(1. - 3.*c2) + a4*(3141900.*pow(r,9.)*(-1. + 3.*c2) + 1309680.*pow(r,10.)*(-1. + 3.*c2) 
     - 9144576.*(299. - 1440.*c2 + 720.*c4) - 4536.*r*(41543. - 947400.*c2 + 420780.*c4) 
     + 1620.*pow(r,2.)*(-93041. - 85688.*c2 + 1454300.*c4) + 12.*pow(r,8.)*(-535899. - 116700.*c2 + 2367475.*c4) 
     + 18.*pow(r,5.)*(-7227915. + 2913384.*c2 + 17254600.*c4) + 36.*pow(r,3.)*(4260605. - 30961368.*c2 + 27684860.*c4) 
     + 3.*pow(r,6.)*(-20890109. + 18841800.*c2 + 46796480.*c4) + pow(r,7.)*(-20549463. + 6081360.*c2 + 59683820.*c4) 
     + 4.*pow(r,4.)*(-33335811. - 120639012.*c2 + 227696380.*c4))))/(40642560.*pow(r,11.));

 
  gcov[3][0] = gcov[0][3];
  gcov[3][1] = gcov[1][3];

  gcov[3][3] =s2 * (rho2+a2*s2*(1. + 2. *r/rho2)) 
     +zeta*(-1./37632.*((338688. + 80808.*r + 67380.*pow(r,2.) + 10360.*pow(r,3.) + 18908.*pow(r,4.) + 9940.*pow(r,5.) 
     + 4221.*pow(r,6.))*a2*(-1. + c2)*(-1. + 3.*c2))/pow(r,7.) + (a4*(-1. + c2)*(3141900.*pow(r,9.)*(-1. + 3.*c2) 
     + 1309680.*pow(r,10.)*(-1. + 3.*c2) - 9144576.*(299. - 1440.*c2 + 720.*c4) 
     + 4536.*r*(119737. + 302280.*c2 + 63060.*c4) + 1620.*pow(r,2.)*(240495. - 1419832.*c2 + 2454908.*c4) 
     + 12.*pow(r,8.)*(-156009. - 1636260.*c2 + 3507145.*c4) + 18.*pow(r,5.)*(-4337355. - 8648856.*c2 + 25926280.*c4) 
     + 36.*pow(r,3.)*(10727645. - 56829528.*c2 + 47085980.*c4) + 3.*pow(r,6.)*(-6926429. - 37012920.*c2 + 88687520.*c4) 
     + pow(r,7.)*(-696903. - 73328880.*c2 + 119241500.*c4) + 4.*pow(r,4.)*(-9548811. - 215787012.*c2 + 299057380.*c4)))/(40642560.*pow(r,11.)));
}

double get_EdGB_Event_Horizon(double th){
    //returns the event horizon for EdGB @ some value of theta 
    double cth = cos(th);
    double sth = sin(th);
    double c2 = cth*cth;
    double c4 = c2*c2;
    double a2 = a*a;
    double a4 = a2*a2;
    double doublecth = cos(2.*th);
    double fourcth = cos(4*th);
    double sixcth = cos(6*th);
    double rho=pow(Rh,2.)+(a2)*(c2);
   

    double dAdr =((-2.*pow((1./sth),2.) + 2.*Rh*pow((1./sth),2.))*pow(sth,2.))/rho - (2.*Rh*(a2 + a2*pow((cth/sth),2.) - 2.*Rh*pow((1./sth),2.) 
    + pow(Rh,2.)*pow((1./sth),2.))*pow(sth,2.))/pow(rho,2.);

    double zB = (-(1./(1481760000.*pow(Rh,15.)*pow(rho,2.)))*zeta*
    (181762560000.* pow(Rh,12.) - 4741632000.* pow(Rh,13.) - 2963520000.* pow(Rh,14.) - 25683840000.* pow(Rh,15.) 
    - 1481760000.* pow(Rh,16.) - 1481760000.* pow(Rh,17.) - 1007596800000.* pow(Rh,8.) *a2 + 1159724160000.* pow(Rh,9.)* a2 - 
    1402709280000. *pow(Rh,10.)* a2 + 142114896000.* pow(Rh,11.) *a2 - 48900700800. *pow(Rh,12.) *a2 + 53172638400.* pow(Rh,13.) *a2 
    + 373806720.* pow(Rh,14.) *a2 + 4914362880. *pow(Rh,15.)* a2 - 518757120.* pow(Rh,16.) *a2 + 740880000. *pow(Rh,17.) *a2 
    + 55516608000000. *pow(Rh,4.) *a4 - 19548760896000. *pow(Rh,5.) *a4 - 5354670686400.* pow(Rh,6.)* a4 + 1198382707200. *pow(Rh,7.) *a4 
    + 4171356174720. *pow(Rh,8.)* a4 + 68875906680. *pow(Rh,9.) *a4 - 603190690872. *pow(Rh,10.)* a4 - 108481166724.* pow(Rh,11.) *a4 
    + 23885586600.* pow(Rh,12.) *a4 + 2479136040. *pow(Rh,13.)* a4 + 1153973880. *pow(Rh,14.)* a4 + 4440560400.* pow(Rh,15.) *a4 
    + 643550400. *pow(Rh,16.) *a4 + 277830000.* pow(Rh,17.) *a4 + 53295943680000.* pow(Rh,2.)* pow(a,6.) - 79881286464000. *pow(Rh,3.)* pow(a,6.) 
    + 9022714176000.* pow(Rh,4.)* pow(a,6.) + 3978059047200.* pow(Rh,5.) *pow(a,6.) + 6290299952160.* pow(Rh,6.)* pow(a,6.) 
    - 6176685450768. *pow(Rh,7.)* pow(a,6.) - 2474400502756.* pow(Rh,8.)* pow(a,6.) - 336101111724.* pow(Rh,9.) *pow(a,6.) 
    + 136367196162. *pow(Rh,10.) *pow(a,6.) + 28733284608.* pow(Rh,11.) *pow(a,6.) + 22945892220.* pow(Rh,12.)* pow(a,6.) 
    + 14073036750.* pow(Rh,13.) *pow(a,6.) + 3945653100. *pow(Rh,14.)* pow(a,6.) + 555660000. *pow(Rh,15.) *pow(a,6.) 
    - 2220664320000.* pow(a,8.) - 29273848128000.* Rh* pow(a,8.) + 10590105086400. *pow(Rh,2.) *pow(a,8.) 
    - 1309228972800. *pow(Rh,3.)* pow(a,8.) - 1056298508160. *pow(Rh,4.) *pow(a,8.) - 3597324111528. *pow(Rh,5.) *pow(a,8.) 
    - 40537711368. *pow(Rh,6.) *pow(a,8.) + 592319885388. *pow(Rh,7.) *pow(a,8.) + 361245395400. *pow(Rh,8.)* pow(a,8.) 
    + 111913351560. *pow(Rh,9.) *pow(a,8.) + 43427843640.* pow(Rh,10.)* pow(a,8.) + 15041732400. *pow(Rh,11.)* pow(a,8.) 
    + 3393532800. *pow(Rh,12.)* pow(a,8.) + 277830000. *pow(Rh,13.) *pow(a,8.) - a2 *(2927957760000. *pow(a,6.) 
    + 37251446400000.* Rh* pow(a,6.) + 18816000.* pow(Rh,2.)* a4* (-3734640. + 226601. *a2) - 2160. *pow(Rh,15.)* (-1406496. + 336445. *a2) 
    - 2160. *pow(Rh,16.) *(-1749496. + 507945. *a2) - 7056000.* pow(Rh,3.) *a4* (-9344860. + 1194713. *a2) - 2160.* pow(Rh,14.) *(519176. 
    - 1345442. *a2 + 169315. *a4) + 1800.* pow(Rh,13.)* (-84505064. + 15438252. *a2 + 2125211. *a4) - 67200.* pow(Rh,4.) *a2 *(1089270000. 
    - 168662060. *a2 + 122164191.* a4) + 3360.* pow(Rh,6.)* a2 *(-872709600. - 3156949945.* a2 + 488604981. *a4) 
    + 1680. *pow(Rh,7.)* a2* (-3196926600. + 258825610. *a2 + 500132009. *a4) + 1680.* pow(Rh,5.)* a2 *(33773544000. + 319744985. *a2 
    + 563086414. *a4) + 90. *pow(Rh,12.)* (2650791360. - 257693616.*a2 + 37572487. *a4 + 12190680. *pow(a,6.)) + 12. *pow(Rh,11.) *(-31527972000. 
    - 13764926980. *a2 + 6988573439. *a4 + 822870900. *pow(a,6.)) + 3.* pow(Rh,10.) *(678820128000. + 320996089120. *a2 + 20927766049. *a4 
    + 9356370720. *pow(a,6.)) + 6.* pow(Rh,9.) *(-678646080000. + 90444320400. *a2 + 53711866327. *a4 + 21037599600.* pow(a,6.)) 
    + 2.* pow(Rh,8.) *(1511395200000. - 1752881188800. *a2 + 568124619097. *a4 + 144182324880.*pow(a,6.))) *doublecth 
    - 10. *a4* (15410304000.* a4 + 234651513600. *Rh* a4 + 1058400. *pow(Rh,2.) *a2 *(-349440. + 585409. *a2) 
    + 403200. *pow(Rh,3.) *a2 *(-1633611. + 1352035. *a2) + 18. *pow(Rh,14.) *(-11639882. + 1523835. *a2) + 162. *pow(Rh,12.) *(-9949118. 
    + 1624883. *a2) + 9. *pow(Rh,13.) *(87114148. + 7266375.* a2) + 42.* pow(Rh,11.) *(31851371. + 58269628. *a2) 
    + 10080. *pow(Rh,4.)* (-38220000. - 11590320. *a2 + 14029417. *a4) + 15.* pow(Rh,10.)* (224385644. + 429386571. *a2 + 25515444. *a4) 
    + 18. *pow(Rh,9.) *(-506168530. + 834645525. *a2 + 172150266.* a4) + 252. *pow(Rh,5.) *(-2337182400. + 752577100. *a2 + 261244437. *a4) 
    + 84. *pow(Rh,6.)* (3526324200. - 703335540. *a2 + 734102599. *a4) + 42.* pow(Rh,7.) *(3616785600. - 1153000908. *a2 + 906178415. *a4) 
    + 2.* pow(Rh,8.)* (-22070104560. + 82338403.* a2 + 6446252538. *a4))* fourcth - 38525760000. *pow(Rh,3.)* pow(a,6.) *sixcth 
    - 80607744000.* pow(Rh,4.)* pow(a,6.) *sixcth - 56563542000.* pow(Rh,5.) *pow(a,6.)* sixcth - 10030860000.* pow(Rh,6.) *pow(a,6.) *sixcth 
    + 17734953600. *pow(Rh,7.)* pow(a,6.) *sixcth - 1928523310.* pow(Rh,8.) *pow(a,6.) *sixcth - 7533532230.* pow(Rh,9.) *pow(a,6.)* sixcth 
    - 5001621165. *pow(Rh,10.) *pow(a,6.)* sixcth - 2204535900.* pow(Rh,11.) *pow(a,6.)* sixcth - 759976650. *pow(Rh,12.) *pow(a,6.) *sixcth));

   return Rh - zB/dAdr;
}


double get_dCS_Event_Horizon(double th){
    //returns the event horizon for dCS @ some value of theta 
    double cth = cos(th);
    double sth = sin(th);
    double c2 = cth*cth;
    double c4 = c2*c2;
    double a2 = a*a;
    double a4 = a2*a2;
    double doublecth = cos(2*th);
    double fourcth = cos(4*th);
    double sixcth = cos(6*th);
    double rho=pow(Rh,2.)+(a2)*(c2);

 
    double dAdr =((-2.*pow((1./sth),2.) + 2.*Rh*pow((1./sth),2.))*pow(sth,2.))/rho - (2.*Rh*(a2 + a2*pow((cth/sth),2.) - 2.*Rh*pow((1./sth),2.) 
    + pow(Rh,2.)*pow((1./sth),2.))*pow(sth,2.))/pow(rho,2.);


    double zB=-(1./(325140480. *pow(Rh,14.) *pow(rho,2.)))*a2 *zeta* 
    (21946982400. *pow(Rh,8.) + 7921670400. *pow(Rh,9.) - 1424304000. *pow(Rh,10.) - 2862864000. *pow(Rh,11.) - 867542400. *pow(Rh,12.) 
    - 65344320. *pow(Rh,13.) - 13517280. *pow(Rh,14.) + 18234720.* pow(Rh,15.) - 254072899584.* pow(Rh,4.) *a2 - 76519144800. *pow(Rh,5.) *a2 
    + 39779347536. *pow(Rh,6.)* a2 - 44782558416. *pow(Rh,7.) *a2 + 10887607872. *pow(Rh,8.) *a2 - 2490955296.* pow(Rh,9.) *a2 
    + 2061866472.* pow(Rh,10.) *a2 + 293505060. *pow(Rh,11.) *a2 - 15248592. *pow(Rh,12.) *a2 + 25826004.* pow(Rh,13.)* a2 
    + 1111680.* pow(Rh,14.) *a2 - 5238720. *pow(Rh,15.) *a2 - 243026251776.* pow(Rh,2.)* a4 + 501607790208. *pow(Rh,3.) *a4 
    + 110893184784. *pow(Rh,4.)* a4 - 31829805288.* pow(Rh,5.) *a4 + 52264571832. *pow(Rh,6.) *a4 + 21763552696. *pow(Rh,7.) *a4 
    + 10224326064.* pow(Rh,8.) *a4 - 679235052. *pow(Rh,9.)* a4 - 1181897770.* pow(Rh,10.) *a4 - 261779454. *pow(Rh,11.)* a4 
    - 82581300.* pow(Rh,12.) *a4 - 40600080. *pow(Rh,13.)* a4 + 11046647808. *(a4*a2) + 142515912672. *Rh *(a4*a2) 
    - 96964023024. *pow(Rh,2.) *(a4*a2) - 60185940912. *pow(Rh,3.) *(a4*a2) + 4689366048.* pow(Rh,4.) *(a4*a2) - 3946148736. *pow(Rh,5.) *(a4*a2) 
    - 6809489976.* pow(Rh,6.) *(a4*a2) - 6196429860. *pow(Rh,7.) *(a4*a2) - 2399133720. *pow(Rh,8.) *(a4*a2) - 581632500. *pow(Rh,9.) *(a4*a2) 
    - 149699520. *pow(Rh,10.) *(a4*a2) - 36671040. *pow(Rh,11.) *(a4*a2) + (26336378880. *(a4*a2) + 321202143360. *Rh *(a4*a2) 
    - 4320. *pow(Rh,14.) *(-5313. + 2168. *a2) - 4320.* pow(Rh,15.)* (-12663. + 3638. *a2) + 544320. *pow(Rh,2.) *a4 *(-1064448. + 662911. *a2) 
    + 576.* pow(Rh,3.) *a4 *(-104045256. + 246517613. *a2) - 240.* pow(Rh,13.) *(23004. - 66175. *a2 + 21828. *a4) + 720. *pow(Rh,12.) *(2065320. 
    - 224330. *a2 + 78677.* a4) + 216. *pow(Rh,4.) *a2 *(-2804336640. + 491273643.* a2 + 244434856. *a4) + 36.* pow(Rh,5.)* a2 *(5765528160. 
    + 1846980697.* a2 + 550482784. *a4) + 12. *pow(Rh,6.) *a2 *(116620560. + 3663439047.* a2 + 1149750344. *a4) 
    + 4.* pow(Rh,7.)* a2 *(-12905334864. + 2977037627.* a2 + 1562043060. *a4) + 9. *pow(Rh,11.) *(-674870400. + 138187120. *a2 + 5300493.* a4 
    + 1746240. *(a4*a2)) + 12. *pow(Rh,9.)* (-1723135680. - 80288448. *a2 + 235100681. *a4 + 35366132. *(a4*a2)) + pow(Rh,10.) *(-1995477120. 
    + 8238836832. *a2 + 766096861. *a4 + 141445440. *(a4*a2)) + 12. *pow(Rh,8.) *(5486745600. - 1027028304. *a2 + 787017115. *a4 
    + 167671344. *(a4*a2)))* doublecth + 2. *a2 *(-3292047360. *a4 - 38264199120. *Rh *a4 + 90. *pow(Rh,12.)* (620998. + 52365. *a2) 
    + 30. *pow(Rh,13.)* (-473495. + 65484. *a2) + 15.* pow(Rh,11.)* (-8487162. + 1224505. *a2) - 3240.* pow(Rh,2.) *a2* (-22353408. + 6002911. *a2) 
    + 25.* pow(Rh,10.) *(-13543800. + 6721859. *a2) + 360.* pow(Rh,3.) *a2 *(-73481688. + 21807673. *a2) + 30. *pow(Rh,9.)* (3779100. 
    + 15497542. *a2 + 834351. *a4) + 1080. *pow(Rh,4.) *(70108416. - 22568157. *a2 + 11725810. *a4) + 12. *pow(Rh,8.) *(440931960. 
    + 87304733.* a2 + 17150060.* a4) + 180. *pow(Rh,5.) *(-364179564. - 47973869.* a2 + 45516994. *a4) + 12.* pow(Rh,6.)* (-417962970. 
    - 52881387.*a2 + 245373910. *a4) + 2. *pow(Rh,7.) *(1130839020. + 998903918.* a2 + 433289835. *a4)) *fourcth 
    - 1646023680. *pow(Rh,3.) *a4 *sixcth + 71510040. *pow(Rh,4.) *a4 *sixcth + 994237740.* pow(Rh,5.)* a4 *sixcth 
    + 423773820. *pow(Rh,6.) *a4 *sixcth + 299057380.* pow(Rh,7.) *a4 *sixcth + 116668260. *pow(Rh,8.) *a4 *sixcth 
    + 66515640. *pow(Rh,9.) *a4 *sixcth + 29810375. *pow(Rh,10.) *a4 *sixcth + 10521435. *pow(Rh,11.) *a4 *sixcth);

    return Rh - zB/dAdr;
}

double event_horizon(double th){
  if(theory==0){
    return Rh + 0.0001;
  }else if(theory==1){
    return get_EdGB_Event_Horizon(th) + 0.0001;
  }else if(theory==2){
    return get_dCS_Event_Horizon(th) + 0.0001;
  }
}