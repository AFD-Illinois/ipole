#include "modified_metrics.h"

#include "decs.h"
#include "geometry.h"
//personal note, try to implement max EH 
int theory = 0; //Theory of Gravity: 0 for General Relativity, 1 for EdGB, and 2 for DCS
double zeta = 0.1; //Deviation from Gravity: Should be between 0 and 0.3
double a;
double Rh;

void gcov_EdGB_ks(double r, double th, double gcov[NDIM][NDIM]){
//Return the Einstein dilaton Gauss Bonet metric in KS coordinates

  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a3 = a*a2;
  double a4 = a2*a2;
  double a5 = a4*a;

   MUNULOOP gcov[mu][nu] = 0.;
  // Compute EdGB metric from KS coordinates (cyclic in t,phi)
  gcov[0][0]=-1.+ (2.*r)/rho2 + 
    zeta*(-1/15.*(-400.+ 96.*r + 66.*pow(r,2.)+ 130.*pow(r,3.)+ 5.*pow(r,4.))/pow(r,7.)+ (a2*(pow(r,7.)*(444696.- 562338.*c2) 
    + 8820000.*(-1.+ 3.*c2) - 19600.*r*(-467.+ 1251.*c2) - 63.*pow(r,8.)*(-3267.+ 8926.*c2) + 1050.*pow(r,3.)*(-1465.+ 11997.*c2) 
    - 2100.*pow(r,2.)*(-955.+ 22577.*c2) - 6.*pow(r,6.)*(-59329.+ 82437.*c2) + 15.*pow(r,5.)*(-52533.+ 455029.*c2) 
    + 10.*pow(r,4.)*(-281221.+ 1218513.*c2)))/(110250.*pow(r,11.)) + (a4*(675.*pow(r,12.)*(-19717.+ 67726.*c2) + 450.*pow(r,11.)*(43312.+ 101589.*c2) 
    - 164640000.*(-70.+ 585.*c2+ 156.*c4) - 8232000.*r*(3949.- 11058.*c2+ 6948.*c4) - 39200.*pow(r,2.)*(189191.- 824825.*c2+ 972045.*c4) 
    + 60.*pow(r,9.)*(717867.- 13885852.*c2+ 12733507.*c4) + 30.*pow(r,10.)*(209773.- 9090216.*c2+ 16888370.*c4) 
    + 1400.*pow(r,3.)*(648009.- 14691730.*c2+ 26074500.*c4) + 420.*pow(r,4.)*(553219.- 32471380.*c2+ 222891320.*c4) 
    - 14.*pow(r,7.)*(-11393603.+ 38599350.*c2+ 359928985.*c4) + 2.*pow(r,8.)*(59964679.- 491173980.*c2+ 452824800.*c4) 
    - 28.*pow(r,5.)*(21852807.+ 12094180.*c2+ 762315255.*c4) - 14.*pow(r,6.)*(42004007.- 226439060.*c2+ 1041312310.*c4)))/(30870000.*pow(r,15.)));
  gcov[0][1]=(2.*r)/rho2 + 
     zeta*(-1/60.*(-1600.- 416.*r + 56.*pow(r,2.)+ 548.*pow(r,3.)+ 294.*pow(r,4.)+ 147.*pow(r,5.)+ 73.*pow(r,6.))/pow(r,7.)
     + (a2*(2285850.*pow(r,8.)+ 69825.*pow(r,9.)+ 617400.*pow(r,10.)+ 141120000.*(-1.+ 3.*c2) - 627200.*r*(-121.+ 288.*c2) 
     - 11200.*pow(r,3.)*(-929.+ 17802.*c2) - 11200.*pow(r,2.)*(-6253.+ 75795.*c2) + 504.*pow(r,6.)*(-8929.+ 114112.*c2) 
     + 1200.*pow(r,5.)*(-17287.+ 122764.*c2) + 480.*pow(r,4.)*(-52522.+ 180841.*c2) + 84.*pow(r,7.)*(12767.+ 228924.*c2)))/(1764000.*pow(r,11.)) 
     + (a4*(1392308050.*pow(r,12.)+ 1041898025.*pow(r,13.)- 1799623000.*pow(r,14.)+ 500.*pow(r,11.)*(-5124459.+ 2241328.*c2) 
     - 10536960000.*(-70.+ 585.*c2+ 156.*c4) - 1580544000.*r*(1083.- 1736.*c2+ 2836.*c4) + 448000.*pow(r,3.)*(-1355339.+ 725916.*c2+ 521022.*c4) 
     - 2508800.*pow(r,2.)*(530336.- 1371665.*c2+ 1865385.*c4) + 7168.*pow(r,5.)*(-25394838.- 42977570.*c2+ 160747005.*c4) 
     + 17920.*pow(r,4.)*(-18316909.- 25501520.*c2+ 325649955.*c4) - 80.*pow(r,9.)*(120391011.+ 543979856.*c2+ 348977760.*c4) 
     + 40.*pow(r,10.)*(-186388779.- 511177616.*c2+ 352826880.*c4) - 896.*pow(r,6.)*(121697859.+ 19970220.*c2+ 463821790.*c4) 
     - 160.*pow(r,8.)*(87716331.+ 307196240.*c2+ 968666736.*c4) - 448.*pow(r,7.)*(75699653.+ 131599120.*c2+ 1095469160.*c4)))/(1975680000.*pow(r,15.)));

  gcov[0][2]=0.0;

  gcov[0][3]=(2.*r*a*(-1.+ c2))/rho2 +
      zeta*(-1/15.*((-400.+ 144.*r + 90.*pow(r,2.)+ 140.*pow(r,3.)+ 9.*pow(r,4.))*a*(-1.+ c2))/pow(r,7.)- (a3*(-1.+ c2)*(pow(r,4.)*(2736210.- 4410530.*c2) 
      + pow(r,5.)*(766015.- 3620183.*c2) - 8820000.*(-1.+ 3.*c2) + 19600.*r*(-467.+ 1551.*c2) - 12.*pow(r,6.)*(26511.+ 6310.*c2) 
      + 750.*pow(r,3.)*(2051.+ 8733.*c2) + 2100.*pow(r,2.)*(-955.+ 21233.*c2) + 3.*pow(r,8.)*(-63529.+ 262520.*c2) + pow(r,7.)*(-406611.+ 563055.*c2)))/(110250.*pow(r,11.)) 
      + (a5*(-1.+ c2)*(1100.*pow(r,11.)*(604577.+ 2765240.*c2) + 275.*pow(r,12.)*(-1565293.+ 9910190.*c2) 
      + pow(r,7.)*(5564719986.+ 15014000340.*c2- 80476531230.*c4) - 5433120000.*(-70.+ 585.*c2+ 156.*c4) - 271656000.*r*(3949.- 12858.*c2+ 5988.*c4) 
      - 1293600.*pow(r,2.)*(189191.- 642545.*c2+ 376485.*c4) + 138600.*pow(r,3.)*(216003.- 6904190.*c2+ 13490140.*c4) 
      + 13860.*pow(r,4.)*(553219.- 39924380.*c2+ 231663920.*c4) + 30.*pow(r,10.)*(9643021.- 248784875.*c2+ 723623755.*c4) 
      + 2.*pow(r,8.)*(2147992407.- 8519941500.*c2+ 1468127080.*c4) + 20.*pow(r,9.)*(80598297.- 1173493593.*c2+ 1518021880.*c4) 
      - 42.*pow(r,6.)*(462044077.- 3947139700.*c2+ 1848679130.*c4) + 308.*pow(r,5.)*(-65558421.+ 118444260.*c2+ 2022864835.*c4)))/(1018710000.*pow(r,15.)));

  gcov[1][0]=gcov[0][1];

  gcov[1][1]=1.+ (2.*r)/rho2 + 
     zeta*((400.+ 304.*r + 598.*pow(r,2.)+ 380.*pow(r,3.)+ 218.*pow(r,4.)+ 58.*pow(r,5.))/(15.*pow(r,7.)) - (a2*(396900.*pow(r,9.)- 35280000.*(-1.+ 3.*c2) 
     - 78400.*r*(17.+ 99.*c2) - 12600.*pow(r,3.)*(-4369.+ 633.*c2) + 980.*pow(r,5.)*(46009.+ 7203.*c2) + 420.*pow(r,7.)*(6684.+ 12533.*c2) 
     + 21.*pow(r,8.)*(39721.+ 41312.*c2) + 2800.*pow(r,2.)*(-60041.+ 235059.*c2) + 40.*pow(r,4.)*(1347041.+ 2150517.*c2) 
     + 12.*pow(r,6.)*(798727.+ 2262494.*c2)))/(441000.*pow(r,11.)) + (a4*(1892233000.*pow(r,13.)+ 25.*pow(r,12.)*(55171231.+ 85149776.*c2) 
     + 100.*pow(r,11.)*(-7500645.+ 98247164.*c2) - 2634240000.*(-70.+ 585.*c2+ 156.*c4) - 131712000.*r*(2549.+ 642.*c2+ 10068.*c4) 
     + 627200.*pow(r,2.)*(-2635481.+ 16660505.*c2+ 1172475.*c4) + 320.*pow(r,9.)*(37055339.+ 177810769.*c2+ 8023029.*c4) 
     + 22400.*pow(r,3.)*(90871261.- 146475830.*c2+ 254284440.*c4) + 20.*pow(r,10.)*(11959097.+ 907145456.*c2+ 405320880.*c4) 
     + 80.*pow(r,8.)*(631201573.+ 1861655120.*c2+ 691306860.*c4) + 6720.*pow(r,4.)*(222514369.- 524040980.*c2+ 729021620.*c4) 
     + 224.*pow(r,7.)*(470763708.+ 1532278990.*c2+ 1060051385.*c4) + 1344.*pow(r,5.)*(513966826.- 1020185960.*c2+ 1451406515.*c4) 
     + 224.*pow(r,6.)*(1074233009.+ 1240174100.*c2+ 3288968330.*c4)))/(493920000.*pow(r,15.)));

  gcov[1][2]=0.0;

  gcov[1][3]=(a*(-1.+ c2)*(r*(2.+ r) + a2*c2))/rho2 
      + zeta*(-1/60.*((-1600.- 224.*r + 248.*pow(r,2.)+ 684.*pow(r,3.)+ 378.*pow(r,4.)+ 189.*pow(r,5.)+ 94.*pow(r,6.))*a*(-1.+ c2))/pow(r,7.)
      - (a3*(-1.+ c2)*(6464045.*pow(r,9.)+ 2495185.*pow(r,10.)- 141120000.*(-1.+ 3.*c2) + 627200.*r*(-121.+ 438.*c2) 
      + 11200.*pow(r,2.)*(47.+ 57063.*c2) + 4800.*pow(r,3.)*(-10073.+ 119472.*c2) + 14.*pow(r,8.)*(555911.+ 642672.*c2) 
      + 160.*pow(r,4.)*(-68889.+ 1863532.*c2) + 4.*pow(r,7.)*(2593463.+ 3116004.*c2) + 8.*pow(r,6.)*(1229291.+ 5668182.*c2) 
      + 16.*pow(r,5.)*(-278405.+ 8480952.*c2)))/(1764000.*pow(r,11.)) - (a5*(-1.+ c2)*(54991814325.*pow(r,13.)+ 73888304175.*pow(r,14.)
      - 150.*pow(r,12.)*(-1137939359.+ 643667904.*c2) - 100.*pow(r,11.)*(-3710302661.+ 3045427264.*c2) 
      + 347719680000.*(-70.+ 585.*c2+ 156.*c4) + 52157952000.*r*(1083.- 2336.*c2+ 2516.*c4) - 14784000.*pow(r,3.)*(-3265751.+ 2073668.*c2+ 65070.*c4) 
      + 82790400.*pow(r,2.)*(383336.- 149885.*c2+ 1496625.*c4) - 591360.*pow(r,4.)*(-55440429.+ 31053430.*c2+ 280971705.*c4) 
      - 19712.*pow(r,5.)*(-879140181.+ 309765960.*c2+ 5879195410.*c4) - 120.*pow(r,10.)*(-5121053291.+ 203299712.*c2+ 8917059360.*c4) 
      - 48.*pow(r,9.)*(-19536651527.- 10408395520.*c2+ 50410986800.*c4) - 896.*pow(r,6.)*(-9277981317.- 2247068940.*c2+ 73059718520.*c4) 
      - 192.*pow(r,7.)*(-18001434689.- 23312788400.*c2+ 136575914000.*c4) - 32.*pow(r,8.)*(-57002393073.- 35940222840.*c2+ 249862541260.*c4)))/(65197440000.*pow(r,15.)));

  gcov[2][2]=rho2+ 
     (zeta*(840.*pow(r,4.)*(8820000.- 6213200.*r - 3416700.*pow(r,2.)- 1855650.*pow(r,3.)+ 887110.*pow(r,4.)+ 800733.*pow(r,5.)
     + 435540.*pow(r,6.)+ 187446.*pow(r,7.))*a2*(1.- 3.*c2) + a4*(45715050.*pow(r,11.)*(-1.+ 3.*c2) + 5625.*pow(r,10.)*(-20749.+ 58131.*c2) 
     + 493920000.*(-70.+ 585.*c2+ 156.*c4) + 24696000.*r*(3049.- 10698.*c2+ 8868.*c4) + 117600.*pow(r,2.)*(280331.- 1711445.*c2+ 1596165.*c4) 
     + 180.*pow(r,9.)*(-1286466.- 846865.*c2+ 5819941.*c4) + 4200.*pow(r,3.)*(2362411.- 16650910.*c2+ 14489100.*c4) 
     - 1260.*pow(r,4.)*(-3173281.- 5026080.*c2+ 26477920.*c4) + 42.*pow(r,8.)*(-18071967.- 940590.*c2+ 54146980.*c4) 
     + 42.*pow(r,6.)*(-19116713.- 46592740.*c2+ 138130070.*c4) - 28.*pow(r,5.)*(11804979.- 261030540.*c2+ 235282135.*c4) 
     + 6.*pow(r,7.)*(-259078241.- 99440670.*c2+ 857000595.*c4))))/(92610000.*pow(r,12.));

  gcov[3][0]=gcov[0][3];
  gcov[3][1]=gcov[1][3];
  gcov[3][2]=gcov[2][3];
  gcov[3][3] =(1.- c2)*(pow(r,2.)+ a2- (2.*r*a2*(-1.+ c2))/rho2) + 
     zeta*(((8820000.- 6213200.*r - 3416700.*pow(r,2.)- 1855650.*pow(r,3.)+ 887110.*pow(r,4.)+ 800733.*pow(r,5.)+ 435540.*pow(r,6.)
     + 187446.*pow(r,7.))*a2*(-1.+ c2)*(-1.+ 3.*c2))/(110250.*pow(r,8.)) - (a4*(-1.+ c2)*(45715050.*pow(r,11.)*(-1.+ 3.*c2) 
     + 5625.*pow(r,10.)*(-20749.+ 58131.*c2) + 493920000.*(-70.+ 585.*c2+ 156.*c4) + 24696000.*r*(3649.- 8958.*c2+ 6528.*c4) 
     + 352800.*pow(r,2.)*(84857.- 350495.*c2+ 320655.*c4) + 12600.*pow(r,3.)*(-82303.- 1443030.*c2+ 1592200.*c4) 
     + 180.*pow(r,9.)*(-411718.- 4345857.*c2+ 8444185.*c4) - 1260.*pow(r,4.)*(1578719.- 11450880.*c2+ 28150720.*c4) 
     + 42.*pow(r,8.)*(-1863327.- 67980150.*c2+ 104977900.*c4) + 28.*pow(r,5.)*(-14247879.- 109560360.*c2+ 137751665.*c4) 
     + 42.*pow(r,6.)*(30654807.- 316973820.*c2+ 358739630.*c4) + 6.*pow(r,7.)*(-25024421.- 1143700950.*c2+ 1667207055.*c4)))/(92610000.*pow(r,12.)));
        
}
void gcov_EdGB_bl(double r, double th, double gcov[NDIM][NDIM]){
//Return the Einstein dilaton Gauss Bonet metric in BL coordinates
//TODO: put the new EdGB metric BL here
  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a3 = a2*a;
  double a4 = a2*a2;
  double a5 = a4*a;
  double mu = 1. + a2*cth*cth/pow(r,2);
   MUNULOOP gcov[mu][nu] = 0.;
  // Compute EdGB metric from BL coordinates (cyclic in t,phi)
  double DD = 1. - 2./r + a2/pow(r,2);
  
  gcov[0][0] = -(1. - 2./(r*mu)) + 
     zeta*(-1/15.*(-400.+ 96.*r + 66.*pow(r,2.)+ 130.*pow(r,3.)+ 5.*pow(r,4.))/pow(r,7.)+ 
       (a2*(pow(r,7.)*(444696.- 562338.*c2) + 
          8820000.*(-1.+ 3.*c2) - 19600.*r*
           (-467.+ 1251.*c2) - 63.*pow(r,8.)*(-3267.+ 
            8926.*c2) + 1050.*pow(r,3.)*(-1465.+ 
            11997.*c2) - 2100.*pow(r,2.)*(-955.+ 
            22577.*c2) - 6.*pow(r,6.)*(-59329.+ 82437.*c2) + 
          15.*pow(r,5.)*(-52533.+ 455029.*c2) + 
          10.*pow(r,4.)*(-281221.+ 1218513.*c2)))/(110250.*pow(r,11.)) + 
       (a4*(675.*pow(r,12.)*(-19717.+ 67726.*c2) + 
          450.*pow(r,11.)*(43312.+ 101589.*c2) - 
          164640000.*(-70.+ 585.*c2+ 156.*c4) - 
          8232000.*r*(3949.- 11058.*c2+ 6948.*c4) - 
          39200.*pow(r,2.)*(189191.- 824825.*c2+ 
            972045.*c4) + 60.*pow(r,9.)*(717867.- 
            13885852.*c2+ 12733507.*c4) + 
          30.*pow(r,10.)*(209773.- 9090216.*c2+ 
            16888370.*c4) + 1400.*pow(r,3.)*(648009.- 
            14691730.*c2+ 26074500.*c4) + 
          420.*pow(r,4.)*(553219.- 32471380.*c2+ 222891320.*
             c4) - 14.*pow(r,7.)*(-11393603.+ 38599350.*
             c2+ 359928985.*c4) + 
          2.*pow(r,8.)*(59964679.- 491173980.*c2+ 
            452824800.*c4) - 28.*pow(r,5.)*(21852807.+ 
            12094180.*c2+ 762315255.*c4) - 
          14.*pow(r,6.)*(42004007.- 226439060.*c2+ 
            1041312310.*c4)))/(30870000.*pow(r,15.)));

  gcov[0][3] = -2.*a*s2/(r*mu) + 
     zeta*(-1/15.*((-400.+ 144.*r + 90.*pow(r,2.)+ 140.*pow(r,3.)+ 9.*pow(r,4.))*a*
          (-1.+ c2))/pow(r,7.)- (a3*(-1.+ c2)*
         (pow(r,4.)*(2736210.- 4410530.*c2) + 
          pow(r,5.)*(766015.- 3620183.*c2) - 
          8820000.*(-1.+ 3.*c2) + 19600.*r*
           (-467.+ 1551.*c2) - 12.*pow(r,6.)*(26511.+ 
            6310.*c2) + 750.*pow(r,3.)*(2051.+ 8733.*c2) + 
          2100.*pow(r,2.)*(-955.+ 21233.*c2) + 
          3.*pow(r,8.)*(-63529.+ 262520.*c2) + 
          pow(r,7.)*(-406611.+ 563055.*c2)))/(110250.*pow(r,11.)) + 
       (a5*(-1.+ c2)*
         (1100.*pow(r,11.)*(604577.+ 2765240.*c2) + 
          275.*pow(r,12.)*(-1565293.+ 9910190.*c2) + 
          pow(r,7.)*(5564719986.+ 15014000340.*c2- 
            80476531230.*c4) - 5433120000.*
           (-70.+ 585.*c2+ 156.*c4) - 
          271656000.*r*(3949.- 12858.*c2+ 5988.*c4) - 
          1293600.*pow(r,2.)*(189191.- 642545.*c2+ 
            376485.*c4) + 138600.*pow(r,3.)*(216003.- 
            6904190.*c2+ 13490140.*c4) + 
          13860.*pow(r,4.)*(553219.- 39924380.*c2+ 
            231663920.*c4) + 30.*pow(r,10.)*(9643021.- 
            248784875.*c2+ 723623755.*c4) + 
          2.*pow(r,8.)*(2147992407.- 8519941500.*c2+ 
            1468127080.*c4) + 20.*pow(r,9.)*(80598297.- 
            1173493593.*c2+ 1518021880.*c4) - 
          42.*pow(r,6.)*(462044077.- 3947139700.*c2+ 
            1848679130.*c4) + 308.*pow(r,5.)*(-65558421.+ 
            118444260.*c2+ 2022864835.*c4)))/
        (1018710000.*pow(r,15.)));

  gcov[3][0] = gcov[0][3];

  gcov[1][1] = mu/DD + 
     zeta*(-1/15.*(-1840.+ 48.*r + 30.*pow(r,2.)+ 260.*pow(r,3.)+ 15.*pow(r,4.)+ 15.*pow(r,5.))/
         (pow((-2.+ r),2.)*pow(r,5.)) + (a2*(55125.*pow(r,10.)+ 
          299880000.*(-1.+ 3.*c2) - 1176000.*r*
           (-496.+ 1413.*c2) + 42.*pow(r,8.)*
           (7787.+ 16014.*c2) - 21.*pow(r,9.)*(-6301.+ 
            26778.*c2) + 6.*pow(r,7.)*(-169753.+ 
            178509.*c2) - 1400.*pow(r,3.)*(-39470.+ 
            296889.*c2) + 1400.*pow(r,2.)*(-222133.+ 
            865731.*c2) - 80.*pow(r,5.)*(-365951.+ 
            1009653.*c2) + 90.*pow(r,4.)*(-501057.+ 
            1414481.*c2) + pow(r,6.)*(-3428093.+ 
            22301529.*c2)))/(110250.*pow((-2.+ r),3.)*pow(r,9.)) + 
       (a4*(5788125.*pow(r,15.)+ 225.*pow(r,14.)*(-144901.+ 
            203178.*c2) - 450.*pow(r,13.)*(-238789.+ 
            339067.*c2) + 16464000000.*
           (-70.+ 585.*c2+ 156.*c4) + 
          98784000.*r*(48009.- 232978.*c2+ 
            13748.*c4) - 3292800.*pow(r,2.)*(1462459.- 
            5543725.*c2+ 1597155.*c4) + 
          30.*pow(r,12.)*(-9771723.- 3121232.*c2+ 
            11639882.*c4) - 30.*pow(r,11.)*(-3716939.- 
            59148640.*c2+ 90116602.*c4) - 
          28.*pow(r,6.)*(1537315067.- 11371159180.*c2+ 
            343277600.*c4) + 5600.*pow(r,3.)*(272959823.- 
            786639750.*c2+ 347081820.*c4) + 
          10.*pow(r,10.)*(-40457041.- 479621928.*c2+ 
            930989658.*c4) + 28.*pow(r,7.)*(-396696052.+ 
            2336490700.*c2+ 1025187015.*c4) + 
          560.*pow(r,4.)*(9892691.- 127506670.*c2+ 
            1452290430.*c4) - 280.*pow(r,5.)*(-78157011.+ 
            2296369510.*c2+ 1738224390.*c4) + 
          2.*pow(r,8.)*(7891214729.- 16305148340.*c2+ 
            7026895110.*c4) - 2.*pow(r,9.)*(1528530734.- 
            2049109850.*c2+ 9100746145.*c4)))/
        (30870000.*pow((-2.+ r),4.)*pow(r,13.)));

  gcov[2][2] = pow(r,2)*mu+ 
     (zeta*(840.*pow(r,4.)*(8820000.- 6213200.*r - 3416700.*pow(r,2.)- 1855650.*pow(r,3.)+ 
          887110.*pow(r,4.)+ 800733.*pow(r,5.)+ 435540.*pow(r,6.)+ 187446.*pow(r,7.))*a2*
         (1.- 3.*c2) + a4*
         (45715050.*pow(r,11.)*(-1.+ 3.*c2) + 5625.*pow(r,10.)*
           (-20749.+ 58131.*c2) + 493920000.*
           (-70.+ 585.*c2+ 156.*c4) + 
          24696000.*r*(3049.- 10698.*c2+ 8868.*c4) + 
          117600.*pow(r,2.)*(280331.- 1711445.*c2+ 
            1596165.*c4) + 180.*pow(r,9.)*(-1286466.- 
            846865.*c2+ 5819941.*c4) + 
          4200.*pow(r,3.)*(2362411.- 16650910.*c2+ 
            14489100.*c4) - 1260.*pow(r,4.)*(-3173281.- 
            5026080.*c2+ 26477920.*c4) + 
          42.*pow(r,8.)*(-18071967.- 940590.*c2+ 
            54146980.*c4) + 42.*pow(r,6.)*(-19116713.- 
            46592740.*c2+ 138130070.*c4) - 
          28.*pow(r,5.)*(11804979.- 261030540.*c2+ 
            235282135.*c4) + 6.*pow(r,7.)*(-259078241.- 
            99440670.*c2+ 857000595.*c4))))/
      (92610000.*pow(r,12.));

  gcov[3][3] = pow(r,2)*sth*sth*(1. + a2/pow(r,2) + 2.*a2*s2/(pow(r,2)*r*mu)) + 
     zeta*(((8820000.- 6213200.*r - 3416700.*pow(r,2.)- 1855650.*pow(r,3.)+ 
          887110.*pow(r,4.)+ 800733.*pow(r,5.)+ 435540.*pow(r,6.)+ 187446.*pow(r,7.))*a2*
         (-1.+ c2)*(-1.+ 3.*c2))/(110250.*pow(r,8.)) - 
       (a4*(-1.+ c2)*
         (45715050.*pow(r,11.)*(-1.+ 3.*c2) + 5625.*pow(r,10.)*
           (-20749.+ 58131.*c2) + 493920000.*
           (-70.+ 585.*c2+ 156.*c4) + 
          24696000.*r*(3649.- 8958.*c2+ 6528.*c4) + 
          352800.*pow(r,2.)*(84857.- 350495.*c2+ 
            320655.*c4) + 12600.*pow(r,3.)*(-82303.- 
            1443030.*c2+ 1592200.*c4) + 
          180.*pow(r,9.)*(-411718.- 4345857.*c2+ 
            8444185.*c4) - 1260.*pow(r,4.)*(1578719.- 
            11450880.*c2+ 28150720.*c4) + 
          42.*pow(r,8.)*(-1863327.- 67980150.*c2+ 
            104977900.*c4) + 28.*pow(r,5.)*(-14247879.- 
            109560360.*c2+ 137751665.*c4) + 
          42.*pow(r,6.)*(30654807.- 316973820.*c2+ 
            358739630.*c4) + 6.*pow(r,7.)*(-25024421.- 
            1143700950.*c2+ 1667207055.*c4)))/
        (92610000.*pow(r,12.)));

}
void EdGB_bl_to_ks(double r, double th, double edgb_T[NDIM][NDIM]) { 

  double sth, cth, c2, c4, s2, rho2, a2, a4;
  cth = cos(th);
  sth = sin(th);

  s2 = sth*sth;
  c2 = cth*cth ;
  c4 = c2*c2;
  a2 = a*a; 
  a4 = a2*a2;
  rho2 = r*r + a*a*cth*cth;

  edgb_T[0][0]=1;
  edgb_T[0][1]= -1. + (pow(r,2.) + a2)/((-1. + r - sqrt(1. - a2) - 
        (-49./40. - (277.*a2)/960. - (145711.*a4)/3225600.)*
         zeta)*(-1. + r + sqrt(1.-a2) + 
        (-1./120. - (613.*a2)/960. + (2792449.*a4)/3225600.)*
         zeta));
  edgb_T[0][2] = 0 ;       
  edgb_T[0][3] = 0 ;

   edgb_T[1][0] = 0 ;
   edgb_T[1][1] = 1 ; 
   edgb_T[1][2] = 0 ;
   edgb_T[1][3] = 0 ;
   edgb_T[2][0] = 0 ;
   edgb_T[2][1] = 0 ; 
   edgb_T[2][2] = 1 ;
   edgb_T[2][3] = 0 ;
   
   edgb_T[3][0] = 0 ;
   edgb_T[3][1]=a/((-1. + r - sqrt(1.-a2) - 
       (-49./40. - (277.*a2)/960. - (145711.*a4)/3225600.)*
        zeta)*(-1. + r + sqrt(1.-a2) + 
       (41./120. + (113497.*a2)/100800. + (38608501.*a4)/
          35481600.)*zeta));
    edgb_T[3][2]=0.0; 
    edgb_T[3][3]=1.0;

}
void gcov_DCS_ks(double r, double th, double gcov[NDIM][NDIM]){
//Return the Dynamical Chern-Simons metric in KS coordinates
  
  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a3 = a*a2;
  double a4 = a2*a2;
  double a5 = a4*a;

    MUNULOOP gcov[mu][nu] = 0.;
  // Compute DCS metric from KS coordinates (cyclic in t,phi)
  gcov[0][0]=-1.+ (2.*r)/rho2 + zeta*((a2*(-338688.*(-1.+ 3.*c2) + 
          4221.*pow(r,6.)*(-1.+ 3.*c2) + 4221.*pow(r,7.)*
           (-1.+ 3.*c2) - 420.*pow(r,2.)*(263.+ 321.*c2) + 
          20.*pow(r,3.)*(-5428.+ 2025.*c2) - 
          20.*pow(r,4.)*(1523.+ 2781.*c2) + 
          168.*r*(-275.+ 3471.*c2) + 
          2.*pow(r,5.)*(-2482.+ 6711.*c2)))/(37632.*pow(r,10.)) + 
       (a4*(-436560.*pow(r,10.)*(-1.+ 3.*c2) - 
          436560.*pow(r,11.)*(-1.+ 3.*c2) + 
          pow(r,5.)*(-27367138.+ 338395440.*c2- 
            79842960.*c4) + pow(r,7.)*(5994779.+ 
            9180120.*c2- 23096700.*c4) + 
          pow(r,8.)*(1835988.+ 14588424.*c2- 20269020.*
             c4) + pow(r,9.)*(609036.+ 6695880.*c2- 
            14028580.*c4) - 3048192.*(299.- 1440.*c2+ 
            720.*c4) + 1512.*r*(200377.- 262200.*c2+ 
            546900.*c4) + 540.*pow(r,2.)*(209695.- 
            1641704.*c2+ 3850652.*c4) + 
          36.*pow(r,4.)*(-1309617.+ 14023212.*c2+ 
            5328620.*c4) + pow(r,6.)*(1493875.+ 
            66961128.*c2+ 66934880.*c4) - 
          12.*pow(r,3.)*(-7413845.- 9229392.*c2+ 156818740.*
             c4)))/(13547520.*pow(r,14.)));

    gcov[0][1]=(2.*r)/rho2 + zeta*(-1/301056.*(a2*(38430.*pow(r,7.)+ 19215.*pow(r,8.)+ 44667.*pow(r,9.)+ 
           2709504.*(-1.+ 3.*c2) + 4032.*pow(r,2.)*
            (97.+ 193.*c2) - 1344.*r*(733.+ 447.*c2) + 
           84.*pow(r,6.)*(1529.+ 994.*c2) + 168.*pow(r,5.)*
            (1127.+ 2200.*c2) + 32.*pow(r,3.)*(25313.+ 
             9972.*c2) + 16.*pow(r,4.)*(30463.+ 47862.*c2)))/
         pow(r,10.)- (a4*(16616754.*pow(r,11.)+ 40468617.*pow(r,12.)+ 
          34100640.*pow(r,13.)+ pow(r,10.)*(7900548.- 58216320.*c2) + 
          97542144.*(299.- 1440.*c2+ 720.*c4) + 
          241920.*r*(20203.- 237864.*c2+ 35772.*c4) - 
          34560.*pow(r,2.)*(34137.+ 11672.*c2+ 
            1800124.*c4) + 72.*pow(r,9.)*(1594449.- 
            7358896.*c2+ 2822080.*c4) + 
          768.*pow(r,4.)*(-1543157.- 18681696.*c2+ 
            8492020.*c4) - 16.*pow(r,8.)*(-5324505.+ 
            66733824.*c2+ 11040520.*c4) - 
          256.*pow(r,6.)*(344923.+ 19052946.*c2+ 
            15954625.*c4) + 64.*pow(r,5.)*(-1116853.- 
            193194456.*c2+ 21476040.*c4) + 
          768.*pow(r,3.)*(-4475005.- 7417476.*c2+ 
            45527060.*c4) - 32.*pow(r,7.)*(332559.+ 
            53414256.*c2+ 51544360.*c4)))/
        (433520640.*pow(r,14.)));
    gcov[0][2]=0.0;
    gcov[0][3]=(2.*r*a*(-1.+ c2))/rho2 + zeta*(-1/112.*((189.+ 120.*r + 70.*pow(r,2.))*a*
          (-1.+ c2))/pow(r,6.)+ (a3*(-1.+ c2)*
         (-10160640.*(-1.+ 3.*c2) + 105828.*pow(r,7.)*
           (-1.+ 5.*c2) + 30.*pow(r,5.)*(2247.+ 95.*c2) + 
          55440.*r*(-25.+ 453.*c2) + 
          15.*pow(r,6.)*(-271.+ 24875.*c2) + 
          360.*pow(r,2.)*(-9205.+ 64257.*c2) + 
          16.*pow(r,4.)*(-40883.+ 112735.*c2) + 
          8.*pow(r,3.)*(-382792.+ 1712045.*c2)))/(1128960.*pow(r,10.)) - 
       (a5*(-1.+ c2)*
         (253500126.*pow(r,11.)*(-1.+ 5.*c2) + 
          825.*pow(r,10.)*(-579283.+ 2007359.*c2) + 
          1408264704.*(299.- 1440.*c2+ 720.*c4) - 
          698544.*r*(200377.- 746040.*c2+ 
            1030740.*c4) - 249480.*pow(r,2.)*(209695.- 
            2247176.*c2+ 4032764.*c4) + 
          84.*pow(r,8.)*(-17277973.- 20585428.*c2+ 
            123744773.*c4) + 5544.*pow(r,3.)*(-7413845.- 
            2922912.*c2+ 192665380.*c4) - 
          14.*pow(r,7.)*(237841947.- 817153200.*c2+ 
            192857740.*c4) + 42.*pow(r,6.)*(-23970449.- 
            80221656.*c2+ 201416960.*c4) + 
          18.*pow(r,9.)*(-42498828.- 73631707.*c2+ 
            455209643.*c4) + 616.*pow(r,4.)*(35359659.- 
            382674420.*c2+ 1128945980.*c4) + 
          84.*pow(r,5.)*(150519259.- 1600861256.*c2+ 
            3476016920.*c4)))/(6258954240.*pow(r,14.)));

      gcov[1][0]=gcov[0][1];

      gcov[1][1]=1.+ (2.*r)/rho2 + 
      zeta*((a2*(44667.*pow(r,8.)- 677376.*(-1.+ 3.*c2) - 
          336.*r*(-1741.+ 2577.*c2) + 
          21.*pow(r,7.)*(3349.+ 2624.*c2) + 
          42.*pow(r,6.)*(2243.+ 5501.*c2) + 
          168.*pow(r,4.)*(-1712.+ 15471.*c2) + 
          36.*pow(r,5.)*(4639.+ 18983.*c2) + 
          168.*pow(r,2.)*(-13961.+ 41625.*c2) + 
          8.*pow(r,3.)*(-115844.+ 596277.*c2)))/(75264.*pow(r,10.)) + 
       (a4*(34100640.*pow(r,12.)+ 12.*pow(r,10.)*(9425519.+ 
            2153220.*c2) + 3.*pow(r,11.)*(28800979.+ 
            5094000.*c2) + pow(r,9.)*(88722252.+ 
            45073920.*c2- 112228640.*c4) - 
          24385536.*(299.- 1440.*c2+ 720.*c4) - 
          12096.*r*(402407.- 2640840.*c2+ 
            904620.*c4) - 8.*pow(r,8.)*(-18530343.+ 
            95285784.*c2+ 14911000.*c4) + 
          96.*pow(r,3.)*(74125625.- 728831088.*c2+ 
            87392300.*c4) - 192.*pow(r,4.)*(1862003.+ 
            77480766.*c2+ 115164800.*c4) - 
          8.*pow(r,7.)*(16908235.+ 280371816.*c2+ 
            125586100.*c4) + 864.*pow(r,2.)*(46048633.- 
            215092120.*c2+ 128516260.*c4) - 
          8.*pow(r,6.)*(203181015.+ 195320136.*c2+ 
            760558480.*c4) - 16.*pow(r,5.)*(320810645.- 
            177099864.*c2+ 1271442120.*c4)))/
        (108380160.*pow(r,14.)));

        gcov[1][2]=0.0;

        gcov[1][3]=(a*(-1.+ c2)*(r*(2.+ r) + a2*c2))/rho2 + 
     zeta*(-1/56.*((-189.- 120.*r - 70.*pow(r,2.)+ (709.*pow(r,6.))/64.)*a*
          (-1.+ c2))/((-2.+ r)*pow(r,6.)) + 
       (a3*(-1.+ c2)*(-468195.*pow(r,8.)- 536655.*pow(r,9.)- 
          40642560.*(-1.+ 3.*c2) + 20160.*r*
           (733.+ 1959.*c2) + 8640.*pow(r,2.)*
           (1673.+ 5939.*c2) + 210.*pow(r,7.)*(-6871.+ 
            7236.*c2) + 12.*pow(r,6.)*(-269333.+ 
            347590.*c2) + 24.*pow(r,5.)*(-213628.+ 
            506835.*c2) + 48.*pow(r,4.)*(-101873.+ 
            584060.*c2) + 32.*pow(r,3.)*(-124492.+ 
            2059265.*c2)))/(4515840.*pow(r,10.)) - 
       (a5*(-1.+ c2)*(14237034525.*pow(r,12.)+ 
          9822762999.*pow(r,13.)+ 630.*pow(r,11.)*(24351847.+ 15366912.*c2) + 
          12.*pow(r,10.)*(2055167671.+ 661796080.*c2) + 
          22532235264.*(299.- 1440.*c2+ 720.*c4) - 
          55883520.*r*(-20203.+ 141096.*c2+ 
            60996.*c4) - 1596672.*pow(r,2.)*(-1939059.+ 
            7011880.*c2+ 6069020.*c4) + 
          88704.*pow(r,3.)*(-2586065.- 69832512.*c2+ 
            134071420.*c4) + 896.*pow(r,7.)*(-27911013.- 
            452817432.*c2+ 982380230.*c4) + 
          2688.*pow(r,6.)*(-90875083.- 349488852.*c2+ 
            1114846730.*c4) + 9856.*pow(r,4.)*(-41602311.- 
            453834864.*c2+ 1235148500.*c4) + 
          112.*pow(r,8.)*(417172557.- 2041108464.*c2+ 
            2487770036.*c4) + 24.*pow(r,9.)*(1992373203.- 
            2983543860.*c2+ 4320802640.*c4) + 
          448.*pow(r,5.)*(-1425858819.- 5438639760.*c2+ 
            19353172240.*c4)))/(100143267840.*pow(r,14.)));

    gcov[2][0]=0.0;
    gcov[2][1]=0.0;
    gcov[2][2]=rho2- 
     (zeta*(1080.*pow(r,4.)*(338688.+ 80808.*r + 67380.*pow(r,2.)+ 10360.*pow(r,3.)+ 
          18908.*pow(r,4.)+ 9940.*pow(r,5.)+ 4221.*pow(r,6.))*a2*
         (1.- 3.*c2) + a4*
         (3141900.*pow(r,9.)*(-1.+ 3.*c2) + 1309680.*pow(r,10.)*
           (-1.+ 3.*c2) - 9144576.*(299.- 1440.*c2+ 
            720.*c4) - 4536.*r*(41543.- 947400.*c2+ 
            420780.*c4) + 1620.*pow(r,2.)*(-93041.- 
            85688.*c2+ 1454300.*c4) + 
          12.*pow(r,8.)*(-535899.- 116700.*c2+ 
            2367475.*c4) + 18.*pow(r,5.)*(-7227915.+ 
            2913384.*c2+ 17254600.*c4) + 
          36.*pow(r,3.)*(4260605.- 30961368.*c2+ 
            27684860.*c4) + 3.*pow(r,6.)*(-20890109.+ 
            18841800.*c2+ 46796480.*c4) + 
          pow(r,7.)*(-20549463.+ 6081360.*c2+ 59683820.*
             c4) + 4.*pow(r,4.)*(-33335811.- 120639012.*
             c2+ 227696380.*c4))))/(40642560.*pow(r,11.));
      gcov[2][3]=0.0;

      gcov[3][0]=gcov[0][3];
      gcov[3][1]=gcov[1][3];
      gcov[3][2]=0.0;
      gcov[3][3]=(1.- c2)*(pow(r,2.)+ a2- 
       (2.*r*a2*(-1.+ c2))/
        rho2) + 
     zeta*(-1/37632.*((338688.+ 80808.*r + 67380.*pow(r,2.)+ 10360.*pow(r,3.)+ 
           18908.*pow(r,4.)+ 9940.*pow(r,5.)+ 4221.*pow(r,6.))*a2*
          (-1.+ c2)*(-1.+ 3.*c2))/pow(r,7.)+ 
       (a4*(-1.+ c2)*
         (3141900.*pow(r,9.)*(-1.+ 3.*c2) + 1309680.*pow(r,10.)*
           (-1.+ 3.*c2) - 9144576.*(299.- 1440.*c2+ 
            720.*c4) + 4536.*r*(119737.+ 302280.*c2+ 
            63060.*c4) + 1620.*pow(r,2.)*(240495.- 
            1419832.*c2+ 2454908.*c4) + 
          12.*pow(r,8.)*(-156009.- 1636260.*c2+ 
            3507145.*c4) + 18.*pow(r,5.)*(-4337355.- 
            8648856.*c2+ 25926280.*c4) + 
          36.*pow(r,3.)*(10727645.- 56829528.*c2+ 
            47085980.*c4) + 3.*pow(r,6.)*(-6926429.- 
            37012920.*c2+ 88687520.*c4) + 
          pow(r,7.)*(-696903.- 73328880.*c2+ 119241500.*
             c4) + 4.*pow(r,4.)*(-9548811.- 215787012.*c2+ 
            299057380.*c4)))/(40642560.*pow(r,11.)));
        


}
void gcov_dCS_bl(double r, double th, double gcov[NDIM][NDIM]){
//Return the dynamical Chern-Simons metric in BL coordinates
//TODO: PUT NEW METRIC HERE

  double cth = cos(th);
  double sth = sin(th);
  double s2 = sth * sth;
  double rho2 = r * r + a * a * cth * cth;

  double c2 = cth * cth;
  double c4 = c2*c2;
  double a2 = a*a;
  double a4 = a2*a2;

   MUNULOOP gcov[mu][nu] = 0.;
  // Compute dCS metric from BL coordinates (cyclic in t,phi)

  double DD = 1. - 2./r + a2/pow(r,2);
  double mu = 1. + a2*cth*cth/pow(r,2);

  gcov[0][0] = -(1. - 2./(r*mu))+ zeta*(-1./13547520.*(a2*(-121927680.*pow(r,4.) + 16632000.*pow(r,5.) + 
           39765600.*pow(r,6.) + 39081600.*pow(r,7.) + 10965600.*pow(r,8.) + 1787040.*pow(r,9.) + 1519560.*pow(r,10.) + 1519560.*pow(r,11.) + 365783040.*pow(r,4.)*c2 - 
           209926080.*pow(r,5.)*c2 + 48535200.*pow(r,6.)*c2 - 14580000.*pow(r,7.)*c2 + 20023200.*pow(r,8.)*c2 - 4831920.*pow(r,9.)*c2 - 4558680.*pow(r,10.)*c2 - 
           4558680.*pow(r,11.)*c2))/pow(r,14.) - (a4*(911409408. - 302970024.*r - 113235300.*pow(r,2.) - 88966140.*pow(r,3.) + 47146212.*pow(r,4) + 27367138.*pow(r,5.) - 1493875.*pow(r,6.) - 
           5994779.*pow(r,7.) - 1835988.*pow(r,8.) - 609036.*pow(r,9.) - 436560.*pow(r,10.) - 436560.*pow(r,11.) - 4389396480.*c2 + 396446400.*r*
           c2 + 886520160.*pow(r,2.)*c2 - 110752704.*pow(r,3.)*c2 - 504835632.*pow(r,4.)*c2 - 338395440.*pow(r,5.)*c2 - 66961128.*pow(r,6.)*c2 - 
           9180120.*pow(r,7.)*c2 - 14588424.*pow(r,8.)*c2 - 6695880.*pow(r,9.)*c2 + 1309680.*pow(r,10.)*c2 + 1309680.*pow(r,11.)*c2 + 2194698240.*c4 - 
           826912800.*r*c4 - 2079352080.*pow(r,2.)*c4 + 1881824880.*pow(r,3.)*c4 - 191830320.*pow(r,4.)*c4 + 79842960.*pow(r,5.)*c4 - 66934880.*pow(r,6.)*c4 + 
           23096700.*pow(r,7.)*c4 + 20269020.*pow(r,8.)*c4 + 14028580.*pow(r,9.)*c4))/(13547520.*pow(r,14.))) ;

  gcov[0][3] = -2.*a*s2/(r*mu) + zeta*(((10561985280*pow(r,8) + 6706022400*pow(r,9) + 3911846400*pow(r,10))*a*
         s2)/(6258954240*pow(r,14)) + (pow(a,3)*(-56330588160*pow(r,4) + 7683984000*pow(r,5) + 18371707200*pow(r,6) + 16977590784*pow(r,7) + 3626485632*pow(r,8) - 373721040*pow(r,9) + 22536360*pow(r,10) + 
         586710432*pow(r,11) + 168991764480*pow(r,4)*c2 - 139233790080*pow(r,5)*c2 - 128246690880*pow(r,6)*c2 - 75932619840*pow(r,7)*c2 - 
         10000045440*pow(r,8)*c2 - 15800400*pow(r,9)*c2 - 2068605000*pow(r,10)*c2 - 2933552160*pow(r,11)*c2)*s2)/(6258954240*pow(r,14)) + 
         (pow(a,5)*(421071146496 - 139972151088*r - 52314708600*pow(r,2) - 41102356680*pow(r,3) + 21781549944*pow(r,4) + 12643617756*pow(r,5) - 
         1006758858*pow(r,6) - 3329787258*pow(r,7) - 1451349732*pow(r,8) - 764978904*pow(r,9) - 477908475*pow(r,10) - 253500126*pow(r,11) - 2027901173760*c2 + 
         521141765760*r*c2 + 560625468480*pow(r,2)*c2 - 16204624128*pow(r,3)*c2 - 235727442720*pow(r,4)*c2 - 134472345504*pow(r,5)*c2 - 
         3369309552*pow(r,6)*c2 + 11440144800*pow(r,7)*c2 - 1729175952*pow(r,8)*c2 - 1325370726*pow(r,9)*c2 + 1656071175*pow(r,10)*c2 + 1267500630*pow(r,11)*c2 + 
         1013950586880*c4 - 720017242560*r*c4 - 1006093962720*pow(r,2)*c4 + 1068136866720*pow(r,3)*c4 + 695430723680*pow(r,4)*c4 + 
         291985421280*pow(r,5)*c4 + 8459512320*pow(r,6)*c4 - 2700008360*pow(r,7)*c4 + 10394560932*pow(r,8)*c4 + 8193773574*pow(r,9)*c4)*s2)/
         (6258954240*pow(r,14))) ;
    
  gcov[1][1] = mu/DD + zeta*((a2*(-3657830400*pow(r,4) + 4212190080*pow(r,5) - 
        1144039680*pow(r,6) + 243781920*pow(r,7) - 330004800*pow(r,8) + 93121920*pow(r,9) - 546480*pow(r,10) - 1519560*pow(r,11) + 1519560*pow(r,12) + 10973491200*pow(r,4)*
        c2 - 8933016960*pow(r,5)*c2 + 1390556160*pow(r,6)*c2 - 846015840*pow(r,7)*c2 + 753991200*pow(r,8)*c2 - 124839360*pow(r,9)*c2 + 
        4285440*pow(r,10)*c2 + 7204680*pow(r,11)*c2 - 4558680*pow(r,12)*c2))/(13547520*pow((2 - r),3)*pow(r,12)) + 
        (a4*(41924832768 - 55560983184*r + 19661682528*pow(r,2) - 3892185204*pow(r,3) + 4726045380*pow(r,4) - 1468894340*pow(r,5) - 249401400*pow(r,6) - 
        11023875*pow(r,7) + 66718519*pow(r,8) - 15329955*pow(r,9) - 1396596*pow(r,10) + 436560*pow(r,11) - 436560*pow(r,12) - 201912238080*c2 + 
        222952383360*r*c2 - 54077483520*pow(r,2)*c2 - 4105960416*pow(r,3)*c2 - 6745675680*pow(r,4)*c2 + 3910163568*pow(r,5)*c2 + 968164320*pow(r,6)*c2 - 
        287437416*pow(r,7)*c2 - 290871480*pow(r,8)*c2 + 76131840*pow(r,9)*c2 - 3237000*pow(r,10)*c2 - 1838880*pow(r,11)*c2 + 1309680*pow(r,12)*c2 + 
        100956119040*c4 - 137881154880*r*c4 + 37014140160*pow(r,2)*c4 + 6359274480*pow(r,3)*c4 + 5547126000*pow(r,4)*c4 - 3376291680*pow(r,5)*c4 - 
        527042000*pow(r,6)*c4 + 55986760*pow(r,7)*c4 + 159391380*pow(r,8)*c4 - 56199680*pow(r,9)*c4 + 
        9469900*pow(r,10)*c4))/(13547520*pow((2 - r),3)*pow(r,12)));

  gcov[2][2] =  pow(r,2)*mu + zeta*((a2*(-365783040*pow(r,4) - 87272640*pow(r,5) - 72770400*pow(r,6) - 
          11188800*pow(r,7) - 20420640*pow(r,8) - 10735200*pow(r,9) - 4558680*pow(r,10) + 1097349120*pow(r,4)*c2 + 261817920*pow(r,5)*c2 + 
          218311200*pow(r,6)*c2 + 33566400*pow(r,7)*c2 + 61261920*pow(r,8)*c2 + 32205600*pow(r,9)*c2 + 13676040*pow(r,10)*c2))/(40642560*pow(r,11)) + 
          (a4*(2734228224 + 188439048*r + 150726420*pow(r,2) - 153381780*pow(r,3) + 133343244*pow(r,4) + 130102470*pow(r,5) + 62670327*pow(r,6) + 
          20549463*pow(r,7) + 6430788*pow(r,8) + 3141900*pow(r,9) + 1309680*pow(r,10) - 13168189440*c2 - 4297406400*r*c2 + 138814560*pow(r,2)*c2 + 1114609248*pow(r,3)*c2 + 
          482556048*pow(r,4)*c2 - 52440912*pow(r,5)*c2 - 56525400*pow(r,6)*c2 - 6081360*pow(r,7)*c2 + 1400400*pow(r,8)*c2 - 9425700*pow(r,9)*c2 - 
          3929040*pow(r,10)*c2 + 6584094720*c4 + 1908658080*r*c4 - 2355966000*pow(r,2)*c4 - 996654960*pow(r,3)*c4 - 910785520*pow(r,4)*c4 - 
          310582800*pow(r,5)*c4 - 140389440*pow(r,6)*c4 - 59683820*pow(r,7)*c4 - 28409700*pow(r,8)*c4))/(40642560*pow(r,11)));

  gcov[3][0] = -2.*a*s2/(r*mu) + zeta*(((10561985280*pow(r,8) + 6706022400*pow(r,9) + 3911846400*pow(r,10))*a*
         s2)/(6258954240*pow(r,14)) + (pow(a,3)*(-56330588160*pow(r,4) + 7683984000*pow(r,5) + 18371707200*pow(r,6) + 16977590784*pow(r,7) + 3626485632*pow(r,8) - 373721040*pow(r,9) + 22536360*pow(r,10) + 
         586710432*pow(r,11) + 168991764480*pow(r,4)*c2 - 139233790080*pow(r,5)*c2 - 128246690880*pow(r,6)*c2 - 75932619840*pow(r,7)*c2 - 
         10000045440*pow(r,8)*c2 - 15800400*pow(r,9)*c2 - 2068605000*pow(r,10)*c2 - 2933552160*pow(r,11)*c2)*s2)/(6258954240*pow(r,14)) + 
         (pow(a,5)*(421071146496 - 139972151088*r - 52314708600*pow(r,2) - 41102356680*pow(r,3) + 21781549944*pow(r,4) + 12643617756*pow(r,5) - 
         1006758858*pow(r,6) - 3329787258*pow(r,7) - 1451349732*pow(r,8) - 764978904*pow(r,9) - 477908475*pow(r,10) - 253500126*pow(r,11) - 2027901173760*c2 + 
         521141765760*r*c2 + 560625468480*pow(r,2)*c2 - 16204624128*pow(r,3)*c2 - 235727442720*pow(r,4)*c2 - 134472345504*pow(r,5)*c2 - 
         3369309552*pow(r,6)*c2 + 11440144800*pow(r,7)*c2 - 1729175952*pow(r,8)*c2 - 1325370726*pow(r,9)*c2 + 1656071175*pow(r,10)*c2 + 1267500630*pow(r,11)*c2 + 
         1013950586880*c4 - 720017242560*r*c4 - 1006093962720*pow(r,2)*c4 + 1068136866720*pow(r,3)*c4 + 695430723680*pow(r,4)*c4 + 
         291985421280*pow(r,5)*c4 + 8459512320*pow(r,6)*c4 - 2700008360*pow(r,7)*c4 + 10394560932*pow(r,8)*c4 + 8193773574*pow(r,9)*c4)*s2)/
         (6258954240*pow(r,14))) ;

  gcov[3][3] = pow(r,2)*sth*sth*(1. + a2/pow(r,2) + 2.*a2*s2/(pow(r,2)*r*mu)) + zeta*
      ((a2*(-365783040*pow(r,4) - 87272640*pow(r,5) - 72770400*pow(r,6) - 11188800*pow(r,7) - 20420640*pow(r,8) - 10735200*pow(r,9) - 4558680*pow(r,10) + 
          1097349120*pow(r,4)*c2 + 261817920*pow(r,5)*c2 + 218311200*pow(r,6)*c2 + 33566400*pow(r,7)*c2 + 61261920*pow(r,8)*c2 + 32205600*pow(r,9)*c2 + 
          13676040*pow(r,10)*c2)*s2)/(40642560*pow(r,11)) + (a4*(2734228224 - 543127032*r - 389601900*pow(r,2) - 
          386195220*pow(r,3) + 38195244*pow(r,4) + 78072390*pow(r,5) + 20779287*pow(r,6) + 696903*pow(r,7) + 1872108*pow(r,8) + 3141900*pow(r,9) + 1309680*pow(r,10) - 
          13168189440*c2 - 1371142080*r*c2 + 2300127840*pow(r,2)*c2 + 2045863008*pow(r,3)*c2 + 863148048*pow(r,4)*c2 + 155679408*pow(r,5)*c2 + 
          111038760*pow(r,6)*c2 + 73328880*pow(r,7)*c2 + 19635120*pow(r,8)*c2 - 9425700*pow(r,9)*c2 - 3929040*pow(r,10)*c2 + 6584094720*c4 - 286040160*r*c4 - 3976950960*pow(r,2)*c4 - 
          1695095280*pow(r,3)*c4 - 1196229520*pow(r,4)*c4 - 466673040*pow(r,5)*c4 - 266062560*pow(r,6)*c4 - 119241500*pow(r,7)*c4 - 42085740*pow(r,8)*c4)*
          s2)/(40642560*pow(r,11)));

}
void dCS_bl_to_ks(double r, double th, double dcs_T[NDIM][NDIM]) { 
  double sth, cth, c2, c4, s2, rho2, a2, a4;
  cth = cos(th);
  sth = sin(th);

  s2 = sth*sth;
  c2 = cth*cth ;
  c4 = c2*c2;
  a2 = a*a; 
  a4 = a2*a2;

  dcs_T[0][0] = 1. ; 
  dcs_T[0][1] = -1.+ (pow(r,2.)+ a2)/((-1.+ r - sqrt(1.- a2) - 
        ((-915.*a2)/28672.- (351479.*a4)/13762560.)*zeta)*
       (-1.+ r + sqrt(1.- a2) + ((477.*a2)/4096.+ 
          (731081.*a4)/13762560.)*zeta)) ;
  dcs_T[0][2] = 0 ;
  dcs_T[0][3] = 0 ;  // FIRST ROW ENDS HERE 
    
  dcs_T[1][0] = 0 ;
  dcs_T[1][1] = 1 ;
  dcs_T[1][2] = 0 ;
  dcs_T[1][3] = 0 ;  // SECOND ROW

  dcs_T[2][0] = 0 ;
  dcs_T[2][1] = 0 ;
  dcs_T[2][2] = 1 ;
  dcs_T[2][3] = 0 ; // THIRD ROW
    
  dcs_T[3][0] = 0 ; 
  dcs_T[3][1] = a/((-1.+ r - sqrt(1.- a2) - 
       ((-915.*a2)/28672.- (351479.*a4)/13762560.)*zeta)*
      (-1.+ r + sqrt(1.- a2) + 
       (709/3584.+ (7477.*a2)/86016.+ (10982957.*a4)/
          151388160.)*zeta));
  dcs_T[3][2] = 0 ; 
  dcs_T[3][3] = 1 ; 
   // FOURTH ROW
    
  } 
double get_EdGB_Event_Horizon(){
    //returns the largest event horizon for EdGB 
    double a2 = a*a;
    double a4 = a2*a2;
    double gr_h = 1. + sqrt(1. - a2);
    //th is pi/2 because that is where EdGB has its peak 
    /*double th = 1.5707963267948;
    double cth = cos(th);
    double sth = sin(th);
    double c2 = cth*cth;
    double c4 = c2*c2;
    double doublecth = cos(2.*th);
    double fourcth = cos(4*th);
    double sixcth = cos(6*th);
    double gr_h = 1. + sqrt(1. - a * a);
    double rho=pow(gr_h,2.)+(a2)*(c2);
    
    Original EH Approximation with theta dependance
    double dAdr =((-2.*pow((1./sth),2.) + 2.*gr_h*pow((1./sth),2.))*pow(sth,2.))/rho - (2.*gr_h*(a2 + a2*pow((cth/sth),2.) - 2.*gr_h*pow((1./sth),2.) 
    + pow(gr_h,2.)*pow((1./sth),2.))*pow(sth,2.))/pow(rho,2.);

    double zB = (-(1./(1481760000.*pow(gr_h,15.)*pow(rho,2.)))*zeta*
    (181762560000.* pow(gr_h,12.) - 4741632000.* pow(gr_h,13.) - 2963520000.* pow(gr_h,14.) - 25683840000.* pow(gr_h,15.) 
    - 1481760000.* pow(gr_h,16.) - 1481760000.* pow(gr_h,17.) - 1007596800000.* pow(gr_h,8.) *a2 + 1159724160000.* pow(gr_h,9.)* a2 
    - 1402709280000. *pow(gr_h,10.)* a2 + 142114896000.* pow(gr_h,11.) *a2 - 48900700800. *pow(gr_h,12.) *a2 + 53172638400.* pow(gr_h,13.) *a2 
    + 373806720.* pow(gr_h,14.) *a2 + 4914362880. *pow(gr_h,15.)* a2 - 518757120.* pow(gr_h,16.) *a2 + 740880000. *pow(gr_h,17.) *a2 
    + 55516608000000. *pow(gr_h,4.) *a4 - 19548760896000. *pow(gr_h,5.) *a4 - 5354670686400.* pow(gr_h,6.)* a4 + 1198382707200. *pow(gr_h,7.) *a4 
    + 4171356174720. *pow(gr_h,8.)* a4 + 68875906680. *pow(gr_h,9.) *a4 - 603190690872. *pow(gr_h,10.)* a4 - 108481166724.* pow(gr_h,11.) *a4 
    + 23885586600.* pow(gr_h,12.) *a4 + 2479136040. *pow(gr_h,13.)* a4 + 1153973880. *pow(gr_h,14.)* a4 + 4440560400.* pow(gr_h,15.) *a4 
    + 643550400. *pow(gr_h,16.) *a4 + 277830000.* pow(gr_h,17.) *a4 + 53295943680000.* pow(gr_h,2.)* pow(a,6.) - 79881286464000. *pow(gr_h,3.)* pow(a,6.) 
    + 9022714176000.* pow(gr_h,4.)* pow(a,6.) + 3978059047200.* pow(gr_h,5.) *pow(a,6.) + 6290299952160.* pow(gr_h,6.)* pow(a,6.) 
    - 6176685450768. *pow(gr_h,7.)* pow(a,6.) - 2474400502756.* pow(gr_h,8.)* pow(a,6.) - 336101111724.* pow(gr_h,9.) *pow(a,6.) 
    + 136367196162. *pow(gr_h,10.) *pow(a,6.) + 28733284608.* pow(gr_h,11.) *pow(a,6.) + 22945892220.* pow(gr_h,12.)* pow(a,6.) 
    + 14073036750.* pow(gr_h,13.) *pow(a,6.) + 3945653100. *pow(gr_h,14.)* pow(a,6.) + 555660000. *pow(gr_h,15.) *pow(a,6.) 
    - 2220664320000.* pow(a,8.) - 29273848128000.* gr_h* pow(a,8.) + 10590105086400. *pow(gr_h,2.) *pow(a,8.) 
    - 1309228972800. *pow(gr_h,3.)* pow(a,8.) - 1056298508160. *pow(gr_h,4.) *pow(a,8.) - 3597324111528. *pow(gr_h,5.) *pow(a,8.) 
    - 40537711368. *pow(gr_h,6.) *pow(a,8.) + 592319885388. *pow(gr_h,7.) *pow(a,8.) + 361245395400. *pow(gr_h,8.)* pow(a,8.) 
    + 111913351560. *pow(gr_h,9.) *pow(a,8.) + 43427843640.* pow(gr_h,10.)* pow(a,8.) + 15041732400. *pow(gr_h,11.)* pow(a,8.) 
    + 3393532800. *pow(gr_h,12.)* pow(a,8.) + 277830000. *pow(gr_h,13.) *pow(a,8.) - a2 *(2927957760000. *pow(a,6.) 
    + 37251446400000.* gr_h* pow(a,6.) + 18816000.* pow(gr_h,2.)* a4* (-3734640. + 226601. *a2) - 2160. *pow(gr_h,15.)* (-1406496. + 336445. *a2) 
    - 2160. *pow(gr_h,16.) *(-1749496. + 507945. *a2) - 7056000.* pow(gr_h,3.) *a4* (-9344860. + 1194713. *a2) - 2160.* pow(gr_h,14.) *(519176. 
    - 1345442. *a2 + 169315. *a4) + 1800.* pow(gr_h,13.)* (-84505064. + 15438252. *a2 + 2125211. *a4) - 67200.* pow(gr_h,4.) *a2 *(1089270000. 
    - 168662060. *a2 + 122164191.* a4) + 3360.* pow(gr_h,6.)* a2 *(-872709600. - 3156949945.* a2 + 488604981. *a4) 
    + 1680. *pow(gr_h,7.)* a2* (-3196926600. + 258825610. *a2 + 500132009. *a4) + 1680.* pow(gr_h,5.)* a2 *(33773544000. + 319744985. *a2 
    + 563086414. *a4) + 90. *pow(gr_h,12.)* (2650791360. - 257693616.*a2 + 37572487. *a4 + 12190680. *pow(a,6.)) + 12. *pow(gr_h,11.) *(-31527972000. 
    - 13764926980. *a2 + 6988573439. *a4 + 822870900. *pow(a,6.)) + 3.* pow(gr_h,10.) *(678820128000. + 320996089120. *a2 + 20927766049. *a4 
    + 9356370720. *pow(a,6.)) + 6.* pow(gr_h,9.) *(-678646080000. + 90444320400. *a2 + 53711866327. *a4 + 21037599600.* pow(a,6.)) 
    + 2.* pow(gr_h,8.) *(1511395200000. - 1752881188800. *a2 + 568124619097. *a4 + 144182324880.*pow(a,6.))) *doublecth 
    - 10. *a4* (15410304000.* a4 + 234651513600. *gr_h* a4 + 1058400. *pow(gr_h,2.) *a2 *(-349440. + 585409. *a2) 
    + 403200. *pow(gr_h,3.) *a2 *(-1633611. + 1352035. *a2) + 18. *pow(gr_h,14.) *(-11639882. + 1523835. *a2) + 162. *pow(gr_h,12.) *(-9949118. 
    + 1624883. *a2) + 9. *pow(gr_h,13.) *(87114148. + 7266375.* a2) + 42.* pow(gr_h,11.) *(31851371. + 58269628. *a2) 
    + 10080. *pow(gr_h,4.)* (-38220000. - 11590320. *a2 + 14029417. *a4) + 15.* pow(gr_h,10.)* (224385644. + 429386571. *a2 + 25515444. *a4) 
    + 18. *pow(gr_h,9.) *(-506168530. + 834645525. *a2 + 172150266.* a4) + 252. *pow(gr_h,5.) *(-2337182400. + 752577100. *a2 + 261244437. *a4) 
    + 84. *pow(gr_h,6.)* (3526324200. - 703335540. *a2 + 734102599. *a4) + 42.* pow(gr_h,7.) *(3616785600. - 1153000908. *a2 + 906178415. *a4) 
    + 2.* pow(gr_h,8.)* (-22070104560. + 82338403.* a2 + 6446252538. *a4))* fourcth - 38525760000. *pow(gr_h,3.)* pow(a,6.) *sixcth 
    - 80607744000.* pow(gr_h,4.)* pow(a,6.) *sixcth - 56563542000.* pow(gr_h,5.) *pow(a,6.)* sixcth - 10030860000.* pow(gr_h,6.) *pow(a,6.) *sixcth 
    + 17734953600. *pow(gr_h,7.)* pow(a,6.) *sixcth - 1928523310.* pow(gr_h,8.) *pow(a,6.) *sixcth - 7533532230.* pow(gr_h,9.) *pow(a,6.)* sixcth 
    - 5001621165. *pow(gr_h,10.) *pow(a,6.)* sixcth - 2204535900.* pow(gr_h,11.) *pow(a,6.)* sixcth - 759976650. *pow(gr_h,12.) *pow(a,6.) *sixcth));

   return gr_h-zB/dAdr;*/
   //return gr_h - (49.0/40.0)*zeta*L_unit - (277.0/960.0)*zeta*(a*a/L_unit);
   /*PhysRevD.105.044008 Paper EH eqn 42
   return gr_h - (49.0/40.0)*zeta - (277.0/960.0)*zeta*(a*a);*/

   //New EH Approximation w/ a^4 and no theta dependance
   return 1. + sqrt(1.-a2) + zeta*(-49./40. - 277.*a2/960. - 145711.*a4/3225600.);
}


double get_dCS_Event_Horizon(){
    //returns the largest event horizon for dCS for theta between 0 and pi
    double a2 = a*a;
    double a4 = a2*a2;
     double gr_h = 1 + sqrt(1. - a2);
    
    //double th = 0.001;
    //double cth = cos(th);
    //double sth = sin(th);
    //double c2 = cth*cth;
    //double c4 = c2*c2;
    
    //double doublecth = cos(2*th);
    //double fourcth = cos(4*th);
    //double sixcth = cos(6*th);
    //double rho=pow(gr_h,2.)+(a2)*(c2);
    
/*
 
     Original EH Approximation with theta dependance
    double dAdr =((-2.*pow((1./sth),2.) + 2.*gr_h*pow((1./sth),2.))*pow(sth,2.))/rho - (2.*gr_h*(a2 + a2*pow((cth/sth),2.) - 2.*gr_h*pow((1./sth),2.) 
    + pow(gr_h,2.)*pow((1./sth),2.))*pow(sth,2.))/pow(rho,2.);


    double zB=-(1./(325140480. *pow(gr_h,14.) *pow(rho,2.)))*a2 *zeta* 
    (21946982400. *pow(gr_h,8.) + 7921670400. *pow(gr_h,9.) - 1424304000. *pow(gr_h,10.) - 2862864000. *pow(gr_h,11.) - 867542400. *pow(gr_h,12.) 
    - 65344320. *pow(gr_h,13.) - 13517280. *pow(gr_h,14.) + 18234720.* pow(gr_h,15.) - 254072899584.* pow(gr_h,4.) *a2 - 76519144800. *pow(gr_h,5.) *a2 
    + 39779347536. *pow(gr_h,6.)* a2 - 44782558416. *pow(gr_h,7.) *a2 + 10887607872. *pow(gr_h,8.) *a2 - 2490955296.* pow(gr_h,9.) *a2 
    + 2061866472.* pow(gr_h,10.) *a2 + 293505060. *pow(gr_h,11.) *a2 - 15248592. *pow(gr_h,12.) *a2 + 25826004.* pow(gr_h,13.)* a2 
    + 1111680.* pow(gr_h,14.) *a2 - 5238720. *pow(gr_h,15.) *a2 - 243026251776.* pow(gr_h,2.)* a4 + 501607790208. *pow(gr_h,3.) *a4 
    + 110893184784. *pow(gr_h,4.)* a4 - 31829805288.* pow(gr_h,5.) *a4 + 52264571832. *pow(gr_h,6.) *a4 + 21763552696. *pow(gr_h,7.) *a4 
    + 10224326064.* pow(gr_h,8.) *a4 - 679235052. *pow(gr_h,9.)* a4 - 1181897770.* pow(gr_h,10.) *a4 - 261779454. *pow(gr_h,11.)* a4 
    - 82581300.* pow(gr_h,12.) *a4 - 40600080. *pow(gr_h,13.)* a4 + 11046647808. *(a4*a2) + 142515912672. *gr_h *(a4*a2) 
    - 96964023024. *pow(gr_h,2.) *(a4*a2) - 60185940912. *pow(gr_h,3.) *(a4*a2) + 4689366048.* pow(gr_h,4.) *(a4*a2) - 3946148736. *pow(gr_h,5.) *(a4*a2) 
    - 6809489976.* pow(gr_h,6.) *(a4*a2) - 6196429860. *pow(gr_h,7.) *(a4*a2) - 2399133720. *pow(gr_h,8.) *(a4*a2) - 581632500. *pow(gr_h,9.) *(a4*a2) 
    - 149699520. *pow(gr_h,10.) *(a4*a2) - 36671040. *pow(gr_h,11.) *(a4*a2) + (26336378880. *(a4*a2) + 321202143360. *gr_h *(a4*a2) 
    - 4320. *pow(gr_h,14.) *(-5313. + 2168. *a2) - 4320.* pow(gr_h,15.)* (-12663. + 3638. *a2) + 544320. *pow(gr_h,2.) *a4 *(-1064448. + 662911. *a2) 
    + 576.* pow(gr_h,3.) *a4 *(-104045256. + 246517613. *a2) - 240.* pow(gr_h,13.) *(23004. - 66175. *a2 + 21828. *a4) + 720. *pow(gr_h,12.) *(2065320. 
    - 224330. *a2 + 78677.* a4) + 216. *pow(gr_h,4.) *a2 *(-2804336640. + 491273643.* a2 + 244434856. *a4) + 36.* pow(gr_h,5.)* a2 *(5765528160. 
    + 1846980697.* a2 + 550482784. *a4) + 12. *pow(gr_h,6.) *a2 *(116620560. + 3663439047.* a2 + 1149750344. *a4) 
    + 4.* pow(gr_h,7.)* a2 *(-12905334864. + 2977037627.* a2 + 1562043060. *a4) + 9. *pow(gr_h,11.) *(-674870400. + 138187120. *a2 + 5300493.* a4 
    + 1746240. *(a4*a2)) + 12. *pow(gr_h,9.)* (-1723135680. - 80288448. *a2 + 235100681. *a4 + 35366132. *(a4*a2)) + pow(gr_h,10.) *(-1995477120. 
    + 8238836832. *a2 + 766096861. *a4 + 141445440. *(a4*a2)) + 12. *pow(gr_h,8.) *(5486745600. - 1027028304. *a2 + 787017115. *a4 
    + 167671344. *(a4*a2)))* doublecth + 2. *a2 *(-3292047360. *a4 - 38264199120. *gr_h *a4 + 90. *pow(gr_h,12.)* (620998. + 52365. *a2) 
    + 30. *pow(gr_h,13.)* (-473495. + 65484. *a2) + 15.* pow(gr_h,11.)* (-8487162. + 1224505. *a2) - 3240.* pow(gr_h,2.) *a2* (-22353408. + 6002911. *a2) 
    + 25.* pow(gr_h,10.) *(-13543800. + 6721859. *a2) + 360.* pow(gr_h,3.) *a2 *(-73481688. + 21807673. *a2) + 30. *pow(gr_h,9.)* (3779100. 
    + 15497542. *a2 + 834351. *a4) + 1080. *pow(gr_h,4.) *(70108416. - 22568157. *a2 + 11725810. *a4) + 12. *pow(gr_h,8.) *(440931960. 
    + 87304733.* a2 + 17150060.* a4) + 180. *pow(gr_h,5.) *(-364179564. - 47973869.* a2 + 45516994. *a4) + 12.* pow(gr_h,6.)* (-417962970. 
    - 52881387.*a2 + 245373910. *a4) + 2. *pow(gr_h,7.) *(1130839020. + 998903918.* a2 + 433289835. *a4)) *fourcth 
    - 1646023680. *pow(gr_h,3.) *a4 *sixcth + 71510040. *pow(gr_h,4.) *a4 *sixcth + 994237740.* pow(gr_h,5.)* a4 *sixcth 
    + 423773820. *pow(gr_h,6.) *a4 *sixcth + 299057380.* pow(gr_h,7.) *a4 *sixcth + 116668260. *pow(gr_h,8.) *a4 *sixcth 
    + 66515640. *pow(gr_h,9.) *a4 *sixcth + 29810375. *pow(gr_h,10.) *a4 *sixcth + 10521435. *pow(gr_h,11.) *a4 *sixcth);

    return gr_h - zB/dAdr;*/

    //PhysRevD.105.044008 Paper EH eqn 42
    //fprintf(stderr, "EH modification: %lf ",(915.0/28672.0)*zeta*(a*a));
    //return gr_h - (915.0/28672.0)*zeta*(a*a);
    
    //New EH Approximation w/ a^4 and no theta dependance
    
    return 1. + sqrt(1.-a2) + zeta*(-915.*a2/28672. - 351479.*a4/13762560.);

    //double partgrh = sqrt(1.-a2);
    //new EH approx w/ higher orders of a 
   /*return gr_h - (a2*zeta*(-3541708800. - 582003072.*a2 - 33752366616.*a4 + 8816814988. *a2*a4 + 497194461. *a4*a4 - 
      122921133. *a4*a4*a2 + 4709520. *a4*a4*a4 - 3541708800.*partgrh + 18819884160.*a2*partgrh - 21596840436.*a4*partgrh + 
      1260933508. *a2*a4*partgrh + 348655133. *a4*a4*partgrh - 28433493. *a4*a4*a2*partgrh + 436560. *a4*a4*a4*partgrh - 
      5.*a2*(1261951488.* (-1. + partgrh) + a4*a4*(6692541. + 929363.*partgrh) + 12.*a4*(27525887. + 23143911.*partgrh) 
      - a2*a4*(111089759. + 27998285.*partgrh) + 12.*a2*(78758906. + 40295327.*partgrh)) - 
      4.*a2*(180.*a4*a4*a2*(21093. + 1819.*partgrh) + 362880.*(-17083. + 17693.*partgrh) - 5. *a4*a4*(21812523. + 4784951.*partgrh) 
      - 12.*a4*(-97206258. + 28640159.*partgrh) + a2*a4*(692178931. + 336274315.*partgrh) - 12.*a2*(457700944. + 370355539.*partgrh))))
      /(54190080.*pow(gr_h,8.)*(-8.*(gr_h) - a4*(4. + partgrh) + 4.*a2*(3. + 2.*partgrh)));*/

      /*(1/((1 + Sqrt[1 - \[Epsilon]^2])^14 (1 - \[Epsilon]^2 + Sqrt[
    1 - \[Epsilon]^2])))(32768 (1 + Sqrt[
      1 - \[Epsilon]^2]) + \[Epsilon]^16 (16 + Sqrt[
      1 - \[Epsilon]^2]) + 
   672 \[Epsilon]^12 (13 + 4 Sqrt[1 - \[Epsilon]^2]) + 
   14080 \[Epsilon]^8 (11 + 6 Sqrt[1 - \[Epsilon]^2]) - 
   16384 \[Epsilon]^2 (9 + 8 Sqrt[1 - \[Epsilon]^2]) - 
   16 \[Epsilon]^14 (43 + 8 Sqrt[1 - \[Epsilon]^2]) + 
   4096 \[Epsilon]^4 (67 + 52 Sqrt[1 - \[Epsilon]^2]) - 
   384 \[Epsilon]^10 (131 + 56 Sqrt[1 - \[Epsilon]^2]) - 
   2048 \[Epsilon]^6 (133 + 88 Sqrt[1 - \[Epsilon]^2])) + 
 1/(13547520 (1 + Sqrt[1 - \[Epsilon]^2])^14 (1 - \[Epsilon]^2 + Sqrt[
     1 - \[Epsilon]^2]))\[Epsilon]^2 (-7083417600 (1 + Sqrt[
       1 - \[Epsilon]^2]) - 
    873120 \[Epsilon]^14 (14 + Sqrt[1 - \[Epsilon]^2]) + 
    496 \[Epsilon]^12 (1010147 + 188674 Sqrt[1 - \[Epsilon]^2]) + 
    16128 \[Epsilon]^2 (1515121 + 1295521 Sqrt[1 - \[Epsilon]^2]) + 
    72 \[Epsilon]^4 (7671087 + 
       140471839 Sqrt[
        1 - \[Epsilon]^2]) - \[Epsilon]^10 (6210850246 + 
       1966956121 Sqrt[1 - \[Epsilon]^2]) + 
    2 \[Epsilon]^8 (13116304389 + 
       6872276057 Sqrt[1 - \[Epsilon]^2]) - 
    4 \[Epsilon]^6 (8991006046 + 
       7264700863 Sqrt[1 - \[Epsilon]^2])) \[Zeta]*/
}

double event_horizon(){
  //return Rh;
  if(theory==0){
    return 1 + sqrt(1. - a * a);
  }else if(theory==1){
    //return 1 + sqrt(1. - a * a);
    return get_EdGB_Event_Horizon();
  }else if(theory==2){
    //return 1 + sqrt(1. - a * a);
    return get_dCS_Event_Horizon();
  }
}
